/*

 Copyright 2013 Google Inc. All Rights Reserved.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
require=function e$$0(h,l,c){function b(d,a){if(!l[d]){if(!h[d]){var k="function"==typeof require&&require;if(!a&&k)return k(d,!0);if(e)return e(d,!0);k=Error("Cannot find module '"+d+"'");throw k.code="MODULE_NOT_FOUND",k;}k=l[d]={exports:{}};h[d][0].call(k.exports,function(a){var e=h[d][1][a];return b(e?e:a)},k,k.exports,e$$0,h,l,c)}return l[d].exports}for(var e="function"==typeof require&&require,a=0;a<c.length;a++)b(c[a]);return b}({162:[function(g,h,l){g("rb-user/user/user.s");g("rb-map/map/map.s");
angular.module("rb-rooms").controller("rb-rooms.UnitCardController",["$scope","$rootScope","rb-users.user","rb-rooms.MapService",function(c,b,e,a){c.shortlistedState=function(){var d;return e.get("account_active")?e.shortlist.getState(c.unit):null!=(null!=(d=c.unit)?d.id:void 0)&&c.shortlistIds&&c.shortlistIds[c.unit.id]?!0:!1};c.shortlist=function(d){c.saving=!0;e.shortlist.save({item:c.unit,success:function(){c.saving=!1;return c.shortlistedState()},error:function(){return c.saving=!1}});d.stopPropagation&&
d.stopPropagation();d.preventDefault&&d.preventDefault();return!1};c.mouseEnterUnit=function(){var d;if(a.map&&a.dataLayer&&(d=c.unit.location.development))return d=a.dataLayer.getFeatureById(d),d={feature:d},a.highlightMarker(d)};return c.mouseLeaveUnit=function(){var d;if(a.map&&a.dataLayer&&(d=c.unit.location.development))return d=a.dataLayer.getFeatureById(d),d={feature:d},a.unhighlightMarker(d)}}])},{"rb-map/map/map.s":85,"rb-user/user/user.s":169}],160:[function(g,h,l){var c;g("rb-user/user/user.s");
g("rb-utils/cookie-storage/cookie-storage.s");g("./shortlist.f");c=g("./shortlist-count-header");angular.module("rb-rooms").directive("rroShortlist",["$rootScope","rb-users.user","rb-utils.CookieStorage","rb-rooms.ShortlistService",function(b,e,a,d){return{restrict:"A",scope:{unit:"=rroShortlist"},link:function(b,k,x){var r,m;r=b.unit.state;m=function(){if("true"===r)return k.removeClass("shortlisted"),r="false";k.addClass("shortlisted");return r="true"};(function(){var d;e.get("id")||(d=a.get("shortlists"),
0===Object.keys(d).length&&(d=[]),d=d.indexOf(b.unit.id),r=-1<d?"true":"false");return"true"===r?k.addClass("shortlisted"):k.removeClass("shortlisted")})();return k.on("click",function(p){var k;p.preventDefault();if(e.get("id")){p={data:{user_id:e.get("id")},error:function(d){return console.log(d)},success:function(d){m();return c.updateCount(d.listings.length)}};if("true"===r)return p.data.listing_id=b.unit.id,d.unshortlist(p);p.data.listing_ids=b.unit.id;return d.shortlist(p)}k=a.get("shortlists");
0===Object.keys(k).length&&(k=[]);"true"===r?(p=k.indexOf(b.unit.id),-1<p&&(k.splice(p,1),c.updateCount(-1))):(k.push(b.unit.id),c.updateCount(1));m();return a.put("shortlists",k)})}}}])},{"./shortlist-count-header":158,"./shortlist.f":161,"rb-user/user/user.s":169,"rb-utils/cookie-storage/cookie-storage.s":175}],61:[function(g,h,l){g("rb-user/user/user.s");g("rb-utils/cookie-storage/cookie-storage.s");g("rb-leads/enquiry/enquiry.s");g("./capture-lead.d");angular.module("rb-rooms").directive("rroContactLister",
["$rootScope","rb-users.user","rb-utils.CookieStorage","rb-rooms.EnquiryService",function(c,b,e,a){return{restrict:"A",scope:{unit:"=rroContactLister"},link:function(d,f,k){var x,r,m;r={};x=function(b){b.preventDefault();if(!r.shown)return a.captureLeadFromPhone({data:{listing_id:d.unit.id,get_phone:"true"},success:function(a){var b,e;m(a);b=a.phone;f.html('<span class="phone primary-subtitle text--normal"><a href="tel:'+b+'" target="_self"><i class="fa fa-phone"></i>&nbsp;'+b+'</a><span class="ut-tooltip arrow-box arrow-box--bottom arrow-box--white">Mention you found this home on 99.co!</span></span>');
f.attr("disabled",!0);e=f.find(".text--normal");e.addClass("ut-tooltip-show");setTimeout(function(){return e.removeClass("ut-tooltip-show")},3500);d.$parent.isMobileViewport&&window.open("tel:"+a.phone,"_top");return r.shown=!0}})};m=function(d){var a;b.get("account_active")?d.capture_email&&(a=!0):"object"===typeof e.get("visitorEmail")&&(a=!0);if(a)return c.$broadcast("show-modal",{name:"email-prompt-modal",data:{source:"show_phone"}},{name:"Email Prompt","Load Origin":"Enquiry"})};return function(){c.$on("shown-modal",
function(a,b){if("enquiry-modal"===b.name)return d.unit=b.data.model});return f.on("click",x)}()}}}])},{"./capture-lead.d":60,"rb-leads/enquiry/enquiry.s":59,"rb-user/user/user.s":169,"rb-utils/cookie-storage/cookie-storage.s":175}],60:[function(g,h,l){g("rb-leads/enquiry/enquiry.s");angular.module("rb-rooms").directive("rroCaptureLead",["rb-rooms.EnquiryService",function(c){return{restrict:"A",scope:{unit:"=rroCaptureLead"},link:function(b,e,a){var d;d={};return e.on("click",function(a){a.preventDefault();
if(!d.shown)return c.captureLeadFromPhone({data:{listing_id:b.unit.id},success:function(a){return d.shown=!0}})})}}}])},{"rb-leads/enquiry/enquiry.s":59}],59:[function(g,h,l){g("./enquiry.f");angular.module("rb-rooms").service("rb-rooms.EnquiryService",["rb-rooms.EnquiryFactory",function(c){return new c}])},{"./enquiry.f":58}],58:[function(g,h,l){angular.module("rb-rooms").factory("rb-rooms.EnquiryFactory",["$FB","$http","$rootScope","Ribs",function(c,b,e,a){return a.Model.extend({initialize:function(){this.models=
[];this.baseUrlEnquiry="/-/make-enquiry";return this.baseUrlShowPhone="/-/show-phone"},add:function(d,a){return d instanceof Array?a?this.models=d:this.models=this.models.concat(d):a?this.models=[d]:this.models.push(d)},purge:function(){return this.models=[]},send:function(d){var a;if(0<this.models.length)return this.sendBulk(schedule,d);a=d.model||this.models[0];d.models=[a.id||a];return this.sendBulk(d)},sendOne:function(d){d.data.enquiry.source="web";return b.post(this.baseUrlEnquiry,d.data).success(function(a){a=
a.models||a;if(d.success)return d.success(a)}).error(function(a){if(d.error)return d.error(a)})},sendBulk:function(d){var a,e;a={units:d.models||this.models};e=[this.baseUrl,this.urlVerb].join("/");return b.post(e,a).success(function(a){a=a.models||a;if(d.success)return d.success(a)}).error(function(a){if(d.error)return d.error(a)})},captureLeadFromPhone:function(d){d.data.source="web";return b.post(this.baseUrlShowPhone,d.data).success(function(a){a=a.models||a;if(d.success)return d.success(a)}).error(function(a){if(d.error)return d.error(a)})}})}])},
{}],188:[function(g,h,l){g("../ribs/ribs.s.js");angular.module("rb-utils").service("rb-utils.ModelsBankService",["Ribs",function(c){return new (c.Model.extend({initialize:function(){this.store={};this.aliases={};this.counts={};this.requests={};return this.watches={}},deposit:function(b,e){var a,d,c,k;if(null!=e)return this.depositModel(b,e);if(b instanceof Array){k=[];a=0;for(d=b.length;a<d;a++)c=b[a],k.push(this.depositModel(c));return k}return this.depositModel(b)},depositModel:function(b,e){var a;
a=null!=e?e:"string"===typeof b?b:b.id;this.store[a]?this.counts[a]++:this.counts[a]=1;this.store[a]=b;return this.checkWatches(a)},checkWatches:function(b){var e,a,d,c;if(null!=this.watches[b]){c=this.watches[b];a=0;for(d=c.length;a<d;a++)e=c[a],e(this.store[b]);return this.releaseModel(b)}},request:function(b,e){return null==this.request[b]?this.request[b]=[e]:this.request[b].push(e)},request:function(b){return"string"===typeof b?b:b.id},watch:function(b,e){return null==this.watches[b]?this.watches[b]=
[e]:this.watches[b].push(e)},withdraw:function(b){var e;b="string"===typeof b?b:b.id;this.store[b]?(e=this.store[b],this.releaseModel(b)):e=null;return e},release:function(b){var e,a,d,c;if(b instanceof Array){c=[];e=0;for(a=b.length;e<a;e++)d=b[e],c.push(this.releaseModel(d));return c}return this.releaseModel(d)},releaseModel:function(b){b="string"===typeof b?b:b.id;this.counts[b]--;if(1>this.counts[b])return this.store[b]=null,this.counts[b]=null}}))}])},{"../ribs/ribs.s.js":194}],187:[function(g,
h,l){angular.module("rb-utils").directive("rutModel",[function(){return{restrict:"A",replace:!1,link:{pre:function(c,b,e){b=e.rutName;e=c.$eval(e.rutModel);return c[b]=e}}}}]).directive("rutModelScope",[function(){return{restrict:"A",replace:!1,scope:!0,link:function(c,b,e){}}}])},{}],85:[function(g,h,l){var c=function(a,d){return function(){return a.apply(d,arguments)}},b=function(a,d){function b(){this.constructor=a}for(var c in d)e.call(d,c)&&(a[c]=d[c]);b.prototype=d.prototype;a.prototype=new b;
a.__super__=d.prototype;return a},e={}.hasOwnProperty;g("./map.f");g("rb-cluster/development-preview.s");g("rb-utils/cookie-storage/cookie-storage.s");angular.module("rb-rooms").service("rb-rooms.MapService",["$rootScope","$timeout","rb-rooms.MappingFactory","rb-rooms.DevelopmentPreviewService","rb-utils.CookieStorage",function(a,d,e,k,x){return new (function(e){function f(){this.canvasClick=c(this.canvasClick,this);this.canvasMouseout=c(this.canvasMouseout,this);this.canvasMouseover=c(this.canvasMouseover,
this);this.displayInfoWindow=c(this.displayInfoWindow,this);this.unselectCurrentMarker=c(this.unselectCurrentMarker,this);this.selectCluster=c(this.selectCluster,this);this.withinRadius=c(this.withinRadius,this);this.toggleAllAreas=c(this.toggleAllAreas,this);this.styleRadiusClusters=c(this.styleRadiusClusters,this);this.onPlaceLoaded=c(this.onPlaceLoaded,this);this.onDistanceDragend=c(this.onDistanceDragend,this);this.onRadiusDragend=c(this.onRadiusDragend,this);this.deselectCurrentFeatureOutsideRadius=
c(this.deselectCurrentFeatureOutsideRadius,this);this.listenToExternalEvents=c(this.listenToExternalEvents,this);return f.__super__.constructor.apply(this,arguments)}b(f,e);f.prototype.init=function(){this.initVariables();this.initMap($(".map-canvas,.map-detail-canvas")[0],Roomboom.map);this.initDataLayer();this.initInfoBox();this.initServices();this.listenToExternalEvents();return a.$emit("map.initialized",this)};f.prototype.initOptions=function(){f.__super__.initOptions.call(this);return this.options.disableDefaultUI=
!0};f.prototype.initInfoBox=function(){var d;d={visible:!0,pixelOffset:new google.maps.Size(-30,-47),maxWidth:0,alignBottom:!0,disableAutoPan:!0,closeBoxURL:""};this.delayHoverPeriod=200;this.infoBoxHTML=document.createElement("div");this.infoBox=new InfoBox(d);return this.infoBoxMarker=new google.maps.Marker({map:this.map,visible:!1})};f.prototype.initDataLayer=function(){this.dataLayer=new google.maps.Data({map:this.map,style:function(d){var a,b;d.getId();b=d.getProperty("type");d=d.getProperty("marker");
"cluster"===b&&(a=d.styleCanvas({isHighResolution:this.isHighResolution}));return{icon:{url:a.url,scaledSize:new google.maps.Size(a.size.width,a.size.height)},zIndex:d.data.zIndex}}});return this.initDataEvents()};f.prototype.initDataEvents=function(){if(null!=this.dataLayer)return google.maps.event.addListener(this.dataLayer,"mouseover",this.canvasMouseover),google.maps.event.addListener(this.dataLayer,"mouseout",this.canvasMouseout),google.maps.event.addListener(this.dataLayer,"click",this.canvasClick)};
f.prototype.listenToExternalEvents=function(d){var b;b=this;a.$on("user.shortlist.updated",function(d,a,e,c,f){d=b.dataLayer.getFeatureById(c);return b.favouriteMarker({feature:d},f)});a.$on("nonUser.shortlist.updated",function(d,a,e){d=b.dataLayer.getFeatureById(a);return b.favouriteMarker({feature:d},e)});a.$on("mapSelected.exitView",this.unselectCurrentMarker);a.$on("unit.exit",this.unselectCurrentMarker);a.$on("mapShow.cluster.present",this.selectCluster);a.$on("mapShow.cluster.reload",this.selectCluster);
a.$on("distance.radius.dragend",this.onRadiusDragend);a.$on("distance.dragend",this.onDistanceDragend);a.$on("place.loaded",this.onPlaceLoaded);return a.$on("map.markers.toggle",this.toggleAllAreas)};f.prototype.deselectCurrentFeatureOutsideRadius=function(d){var a;if(this.currentFeature&&(a=this.currentFeature.getProperty("marker"),!this.withinRadius(d,this.getMarkerPosition(a))))return this.unselectCurrentMarker()};f.prototype.onRadiusDragend=function(d,a){this.radius=Math.round(a.get("radius"));
return this.deselectCurrentFeatureOutsideRadius(a.position)};f.prototype.onDistanceDragend=function(d,a){this.center=a.get("position");return this.deselectCurrentFeatureOutsideRadius(this.center)};f.prototype.onPlaceLoaded=function(d,a){return this.styleRadiusClusters(d,this.center)};f.prototype.fetchCluster=function(d){return k.fetch({model:{id:d,useDevelopmentId:!0},data:{page:1,count:!0,markers:!1,units:!1}})};f.prototype.styleRadiusClusters=function(d,a){var b,e,c,f,k,x;a=a||this.center;k=this.markers.cluster;
x=[];e=0;for(c=k.length;e<c;e++)b=k[e],f=this.getMarkerPosition(b),this.withinRadius(a,f)?"within"!==b.data.range?(b.data.range="within",(b=this.shouldShowAllMarkers?this.dataLayer.getFeatureById(b.data.id):this.dataLayer.add(b.feature))?x.push(b.setProperty("range","within")):x.push(void 0)):x.push(void 0):"outside"!==b.data.range?(b.data.range="outside",(b=this.shouldShowAllMarkers?this.dataLayer.getFeatureById(b.data.id):this.dataLayer.remove(b.feature))?x.push(b.setProperty("range","outside")):
x.push(void 0)):x.push(void 0);return x};f.prototype.toggleAllAreas=function(){return setTimeout(function(d){return function(){var a,b,e,c,f;c=d.markers.cluster;f=[];a=0;for(b=c.length;a<b;a++)e=c[a],"outside"===e.data.range?d.shouldShowAllMarkers?f.push(d.dataLayer.add(e.feature)):f.push(d.dataLayer.remove(e.feature)):f.push(void 0);return f}}(this),100)};f.prototype.withinRadius=function(d,a){return google.maps.geometry.spherical.computeDistanceBetween(d,a)<=this.radius+5};f.prototype.getMarkerPosition=
function(d){return new google.maps.LatLng(d.data.lat,d.data.lng)};f.prototype.selectCluster=function(d,a){var b,e;b=a.cluster.id;e=this.dataLayer.getFeatureById(b);if(null!=e)return e.getProperty("marker"),this.selectMarker({feature:e,id:b});if(b)return this.setSelected(b)};f.prototype.setSelected=function(d){return this.currentId=d};f.prototype.unselectCurrentMarker=function(d,a){var b,e;if(null!=this.currentFeature)return b=this.currentFeature,e=b.getProperty("marker"),e.data.selected=!1,this.unselectMarker({feature:b})};
f.prototype.displayInfoWindow=function(d,a){var b,e,c,f,k;d.title&&(c=d.title);b=d.development;f=b.photos&&0<b.photos.length?b.photos[0].url:"/static/img/placeholder/image-placeholder.png";b="hdb"===b.development_type?"HDB":b.development_type;d.count&&(e=d.count.matched,k=d.count.total);this.infoBoxHTML.innerHTML='<div class="marker-summary arrow_box clearfix"><div class="marker-img-container pull-left"><img class="marker-img" src="'+f+'" alt="marker image"/></div><div class="pull-left marker-info"><h5 class="marker-main-info hide-overflow">'+
c+" - "+b+'</h5><p class="marker-sub-info hide-overflow">'+e+" Listings ("+k+' Total)</p></div><div class="arrow-down"></div></div>';this.infoBox.setContent(this.infoBoxHTML);this.infoBoxMarker.setPosition(a.getGeometry().get());this.infoBox.open(this.map,this.infoBoxMarker);return this.isInfoBoxOpen=!0};f.prototype.highlightMarker=function(d){var a;d=d.feature;if(d!==this.currentFeature&&d)return a=d.getProperty("marker"),a.data.currentZIndex=a.data.zIndex,a.data.zIndex=1,a.data.status="highlighted",
d.setProperty("status","highlighted")};f.prototype.canvasMouseover=function(a){var b,e;this.dragging||(this.highlightMarker(a),b=a.feature,e=a.feature.getProperty("marker"),this.delayHover=d(function(d){return function(){return d.fetchCluster(e.data.id).then(function(a){return d.displayInfoWindow(a.data,b)})}}(this),this.delayHoverPeriod))};f.prototype.canvasMouseout=function(a){var b;d.cancel(this.delayHover);this.isInfoBoxOpen&&this.infoBox.close();a=a.feature;b=a.getProperty("marker");b.data.zIndex=
b.data.currentZIndex;if(!this.dragging||"highlighted"===b.data.status)if(b.data.status="normal",a.setProperty("status","normal"),b.data.visited&&(b.data.status="visited",a.setProperty("status","visited")),b.data.favourited&&(b.data.status="favourited",a.setProperty("status","favourited")),b.data.selected)return b.data.status="selected",a.setProperty("status","selected")};f.prototype.canvasClick=function(d){var b,e;if(!this.dragging&&(b=d.feature,b!==this.currentFeature))return b=b.getProperty("marker"),
e=x.get("seen"),e[b.data.id]=!0,x.put("seen",e),b.onClick(),this.selectMarker(d),a.$emit("tab.condo.setTab","units")};f.prototype.selectMarker=function(d){var a;a=d.feature;a!==this.currentFeature&&(this.unselectMarker(d),this.currentId=d.id||a.getId(),d=a.getProperty("marker"),d.data.visited=!0,d.data.selected=!0,d.data.currentZIndex=d.data.zIndex,d.data.zIndex=1,d.data.status="selected",a.setProperty("status","selected"),this.currentFeature=a)};f.prototype.unselectMarker=function(d){this.currentId=
null;this.currentFeature&&(d=this.currentFeature.getProperty("marker"),d.data.selected=!1,d.data.currentZIndex=d.data.zIndex,d.data.zIndex=1,d.data.favourited&&"undefined"!==typeof d.data.favourited||(d.data.status="visited",this.currentFeature.setProperty("status","visited")),d.data.favourited&&(d.data.status="favourited",this.currentFeature.setProperty("status","favourited")),this.currentFeature=null)};f.prototype.favouriteMarker=function(d,a){var b,e;if(b=d.feature)e=b.getProperty("marker"),e.data.visited=
!0,a?(e.data.favourited=!1,e.data.status="highlighted",b.setProperty("status","highlighted")):(e.data.favourited=!0,e.data.status="favourited",b.setProperty("status","favourited"))};f.prototype.unhighlightMarker=function(d){var a;if(d=d.feature)if(a=d.getProperty("marker"),a.data.status="normal",d.setProperty("status","normal"),a.data.visited&&(a.data.status="visited",d.setProperty("status","visited")),a.data.favourited&&(a.data.status="favourited",d.setProperty("status","favourited")),a.data.selected)return a.data.status=
"selected",d.setProperty("status","selected")};return f}(e))}])},{"./map.f":84,"rb-cluster/development-preview.s":42,"rb-utils/cookie-storage/cookie-storage.s":175}],84:[function(g,h,l){var c=function(b,a){return function(){return b.apply(a,arguments)}},b=[].indexOf||function(b){for(var a=0,d=this.length;a<d;a++)if(a in this&&this[a]===b)return a;return-1};g("rb-map/marker/marker.f");g("rb-utils/cookie-storage/cookie-storage.s");angular.module("rb-rooms").factory("rb-rooms.MappingFactory",["$rootScope",
"$timeout","rb-rooms.MarkerFactory","rb-utils.CookieStorage",function(e,a,d,f){return function(){function a(){this.loadMarkersFromCookie=c(this.loadMarkersFromCookie,this);this.clickMarker=c(this.clickMarker,this);this.showAllMarkers=c(this.showAllMarkers,this);this.addMarker=c(this.addMarker,this);this.hideMarker=c(this.hideMarker,this);this.showMarker=c(this.showMarker,this)}a.prototype.initVariables=function(){var d,a,b,e,c;this.markerCount=0;d=new google.maps.LatLng(1.298593,103.844619);this.radius=
1E3;this.minRadius=1;this.maxRadius=5E3;this.defaults={};this.flags={};this.markers={};this.markerIds={};this.states={};this.defaults.zoom=15;this.defaults.minZoom=11;this.defaults.maxZoom=20;this.defaults.center=d;this.defaults.radius=this.radius;this.defaults.pan={x:0};this.types="cluster nearby listing beacon drag still-beacon".split(" ");this.isHighResolution=this.detectHighResolution;b=this.types;e=[];d=0;for(a=b.length;d<a;d++)c=b[d],this.markerIds[c]={},e.push(this.markers[c]=[]);return e};
a.prototype.initMap=function(d,a){if(d)return this.el=d,this.initOptions(),this.map=a?a:new google.maps.Map(d,this.options),this.map.panBy(this.defaults.pan.x,0),this.transitLayer=new google.maps.TransitLayer,this.transitLayer.setMap(this.map),this.initStyles(),this.map.setOptions({styles:this.styles}),this.recordPosition()};a.prototype.detectHighResolution=function(){var d;d=function(){return(window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches||
window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches)||window.devicePixelRatio&&2<window.devicePixelRatio)&&/(iPad|iPhone|iPod)/g.test(navigator.userAgent)};return window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||
window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&1.3<window.devicePixelRatio||d()};a.prototype.initOptions=function(){return this.options={center:this.defaults.center,zoom:this.defaults.zoom,maxZoom:this.defaults.maxZoom,minZoom:this.defaults.minZoom,mapTypeId:google.maps.MapTypeId.ROADMAP,
disableDoubleClickZoom:!1,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},panControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP},mapTypeControl:!1}};a.prototype.initStyles=function(){this.styles=[{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#c2d6ec"}]},{featureType:"road.highway",stylers:[{visibility:"simplified"},{color:"#e8e8e8"}]},{featureType:"road.arterial",
elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"administrative",stylers:[{saturation:-50}]},{featureType:"landscape",stylers:[{saturation:-50}]},{featureType:"poi",stylers:[{saturation:-50}]},{featureType:"road",stylers:[{saturation:-50}]},{featureType:"water",stylers:[{saturation:-50}]}];return this.styles=[]};a.prototype.initServices=function(){this.directionsService=
new google.maps.DirectionsService;this.directionsDisplay=new google.maps.DirectionsRenderer({preserveViewport:!1,suppressMarkers:!0});return this.geocoder=new google.maps.Geocoder};a.prototype.disableControl=function(){return this.map.setOptions({draggable:!1})};a.prototype.enableControl=function(){return this.map.setOptions({draggable:!0})};a.prototype.centerMap=function(){return null!=this.states.curCenter?this.map.setCenter(this.states.curCenter):this.map.setCenter(this.defaults.center)};a.prototype.centerTo=
function(d){this.map.setCenter(d);return this.center=d};a.prototype.getBoundsZoomLevel=function(d,a){var b,e,c,f;a=a||{height:$(this.el).height(),width:$(this.el).width()};b=function(d){d=Math.sin(d*Math.PI/180);d=Math.log((1+d)/(1-d))/2;return Math.max(Math.min(d,Math.PI),-Math.PI)/2};c=function(d,a,b){return Math.floor(Math.log(d/a/b)/Math.LN2)};e=d.getNorthEast();f=d.getSouthWest();b=(b(e.lat())-b(f.lat()))/Math.PI;e=e.lng()-f.lng();e=(0>e?e+360:e)/360;b=c(a.height,256,b);c=c(a.width,256,e);return Math.min(b,
c,21)};a.prototype.defaultPositionMap=function(){this.map.setCenter(this.defaults.center);this.map.setZoom(this.defaults.zoom);this.defaults.pan.x=0;return this.map.panBy(this.defaults.pan.x,0)};a.prototype.repositionMap=function(){null!=this.states.prevCenter&&this.map.setCenter(this.states.prevCenter);if(null!=this.states.prevZoom)return this.map.setZoom(this.states.prevZoom)};a.prototype.recordCenter=function(d){this.states.prevCenter=this.states.curCenter;return this.states.curCenter=d};a.prototype.recordPosition=
function(d){this.states.prevZoom=this.states.curZoom;this.states.curZoom=this.map.zoom;this.states.prevCenter=this.states.curCenter;return this.states.curCenter=this.map.center};a.prototype.resetMap=function(){var d,a,b,e;e=["cluster","nearby"];d=0;for(a=e.length;d<a;d++)b=e[d],this.resetMarkers(b);this.states.oldNeighbourhood=this.states.curNeighbourhood;this.states.curNeighbourhood="";return this.resetBeacon()};a.prototype.mergeMarkers=function(a,e){var c,f,k,q,g,h,l;if(0<=b.call(this.types,e)){this.markerCount=
0;this.resetWithMarkers([],e);this.destroyDataLayer();this.initDataLayer();l=[];c=[];h=[];for(q in a)k=a[q],f=this.markerIds[e][q],null!=f?((null!=(g=f.data)?g.content:void 0)!==k.content&&f.updateContent(k.content),l.push(this.markerIds[e][q])):(k.mapping=this,f=new google.maps.LatLng(k.lat,k.lng),q===this.currentId&&(k.status="selected"),this.withinRadius(this.center,f)?(k.range="within",this.markerCount++):k.range="outside",k=new d(k),k.createCanvas({shouldShowAllMarkers:this.shouldShowAllMarkers}),
c.push(k));f=this.markers[e];q=0;for(g=f.length;q<g;q++)k=f[q],k.data.id&&null==a[k.data.id]&&h.push(k);this.resetWithMarkers(c.concat(l),e);this.loadMarkersFromCookie();this.currentId&&(q=this.dataLayer.getFeatureById(this.currentId),this.selectMarker({feature:q,id:this.currentId}));return[h,l,c]}};a.prototype.resetWithMarkers=function(d,a){var b,e,c,f;this.markers[a]=d;this.markerIds[a]={};f=[];b=0;for(e=d.length;b<e;b++)c=d[b],f.push(this.markerIds[a][c.data.id]=c);return f};a.prototype.removeMarkers=
function(d,a){var b,e,c,f,k,g;b=[];k=this.markers[a];e=0;for(c=k.length;e<c;e++)f=k[e],null!=f&&null!=(g=f.data)&&g.id?-1!==d.indexOf(f)&&b.push(f):b.push(f);return this.resetWithMarkers(b,a)};a.prototype.addMarkers=function(d,a){var b,e,f,c;c=[];b=0;for(e=d.length;b<e;b++)f=d[b],c.push(this.addMarker(f,a));return c};a.prototype.destroyDataLayer=function(){if(this.dataLayer)return this.dataLayer.setMap(null)};a.prototype.resetBeacon=function(){return this.beacon=null};a.prototype.resetMarkers=function(d){this.destroyMarkers(d);
this.markers[d]=[];return this.markerIds[d]={}};a.prototype.distance=function(d){var a;a=this.map.getBounds();d=a.getNorthEast();a=a.getSouthWest();return google.maps.geometry.spherical.computeDistanceBetween(a,d)};a.prototype.showMarker=function(d){return d.show()};a.prototype.hideMarker=function(d){return d.hide()};a.prototype.addMarker=function(d,a){var b;this.markers[a].push(d);return null!=(null!=(b=d.data)?b.id:void 0)?this.markerIds[a][d.data.id]=d:this.markerIds[a][d]=d};a.prototype.showAllMarkers=
function(d){var a,b,e,f;e=this.markers[d];f=[];d=0;for(a=e.length;d<a;d++)b=e[d],f.push(this.showMarker(b));return f};a.prototype.showMarkers=function(d,a){var b,e,f,c;d=d||this.markers[a];c=[];b=0;for(e=d.length;b<e;b++)f=d[b],c.push(f.show());return c};a.prototype.hideMarkers=function(d,a){var b,e,f,c;d=d||this.markers[a];c=[];b=0;for(e=d.length;b<e;b++)f=d[b],c.push(f.hide());return c};a.prototype.wipeMarkers=function(d,a){var b,e,f,c;d=d||this.markers[a];c=[];b=0;for(e=d.length;b<e;b++)f=d[b],
c.push(f.wipe());return c};a.prototype.destroyMarker=function(d){d.destroy();return null};a.prototype.destroyMarkers=function(d,a){var b,e,f,c;a=a||this.markers[d];c=[];b=0;for(e=a.length;b<e;b++)f=a[b],c.push(this.destroyMarker(f));return c};a.prototype.clickMarker=function(){this.markers.room[0].click();return this.map.setCenter(this.markers.room[0].marker.getPosition())};a.prototype.loadMarkersFromCookie=function(){var d,a,b,e,c;b=f.get("seen");c=f.get("shortlistedMarkers");for(a in c)d=this.dataLayer.getFeatureById(a),
"undefined"!==typeof d&&this.favouriteMarker({feature:d});e=[];for(a in b)c[a]?e.push(void 0):(d=this.dataLayer.getFeatureById(a),"undefined"!==typeof d?(b=d.getProperty("marker"),b.data.visited=!0,b.data.status="visited",e.push(d.setProperty("status","visited"))):e.push(void 0));return e};return a}()}])},{"rb-map/marker/marker.f":86,"rb-utils/cookie-storage/cookie-storage.s":175}],86:[function(g,h,l){var c=function(b,e){return function(){return b.apply(e,arguments)}};g("../richmarker/richmarker");
angular.module("rb-rooms").factory("rb-rooms.MarkerFactory",["$timeout","$rootScope",function(b,e){return function(){function a(d){this.mouseout=c(this.mouseout,this);this.mouseover=c(this.mouseover,this);this.canvasClick=c(this.canvasClick,this);this.canvasMouseout=c(this.canvasMouseout,this);this.canvasMouseover=c(this.canvasMouseover,this);var a;this.defaults={};this.override={};this.data=d;null!=this.data.mapping&&(this.mapping=this.data.mapping);null!=(null!=(a=this.data.mapping)?a.dataLayer:
void 0)&&(this.dataLayer=this.data.dataLayer);if("beacon"===this.data.type)this._labelClass=["beacon","override"];else if("still-beacon"===this.data.type)this._labelClass=["still-beacon","override"];else if("drag"===this.data.type)this._labelClass=["drag","override"];else if("listing"===this.data.type||"direction"===this.data.type)this._labelClass=["room","override"]}a.prototype.dataUrls={};a.prototype.onClick=function(){return e.$emit("mapSelected.cluster.clicked",{cluster:{id:this.data.id}},1<this.data.content?
{event:"unit"}:{})};a.prototype.styleCanvas=function(d){var a,b,e,c,m,p,g,q,h,l,v,u,y,A;d=d||{};p="#2e78b0";y=u="#fff";v=d.status||this.data.status;e=d.range||this.data.range;"highlighted"===v?(p="#fff",y=u="#2e78b0"):"selected"===v?(p="#fff",y=u="#0283E6"):"listed"===v?(p="#85adcc",y=u="#fff"):"visited"===v?(p="#549ed6",y=u="#fff"):"favourited"===v&&(p="#CD2265",y=u="#fff");d=d.text||this.data.content;if("within"===e||"highlighted"===v||"selected"===v)this.hasDataUrl(v,d,g)&&this.getDataUrl(null,
null,v,d,g),g=1;else return this.getCircleCanvas();A=0;q="selected"===v?17:10>this.data.content?10:10<=this.data.content&&50>=this.data.content?12:15;20>this.data.content&&10<=this.data.content&&11!==this.data.content&&(A=-1);e=document.createElement("canvas");c=e.getContext("2d");e.width=2*q+4;e.height=2*q+14;l={width:e.width,height:e.height};m=window.devicePixelRatio||1;b=c.webkitBackingStorePixelRatio||c.mozBackingStorePixelRatio||c.msBackingStorePixelRatio||c.oBackingStorePixelRatio||c.backingStorePixelRatio||
1;h=m/b;"undefined"===typeof a&&(a=!0);a&&m!==b&&(b=e.width,a=e.height,e.width=b*h,e.height=a*h,e.style.width=b+"px",e.style.height=a+"px",c.scale(h,h));c.fillStyle=p;c.strokeStyle=u;c.lineWidth=2;c.globalAlpha=g;c.beginPath();c.moveTo(q+2,2*q+12);c.arc(q+2,q+2,q,Math.PI-Math.PI/5,Math.PI/5);c.closePath();c.fill();c.stroke();c.fillStyle=y;null!=d&&(c.textAlign="center",c.textBaseline="middle",c.font="300 11px 'Helvetica'",c.fillText(d,q+2+A,q+2+2,2*q));return this.getDataUrl(e,l,v,d,g)};a.prototype.getCircleCanvas=
function(d){d=d||{};return{url:d.isHighResolution?"/static/img/icons/marker-untouched-2x.png":"/static/img/icons/marker-untouched.png",size:{width:12,height:12}}};a.prototype.styleCircleCanvas=function(d){var a,b,e,c,m,p,g,q,h;d=d||{};e=document.createElement("canvas");e.getContext("2d");g=(d.radius||10)/2;e=document.createElement("canvas");m=e.getContext("2d");e.width=2*g+4;e.height=2*g+4;h={width:e.width,height:e.height};d=e.width/2;c=e.height/2;p=window.devicePixelRatio||1;b=m.webkitBackingStorePixelRatio||
m.mozBackingStorePixelRatio||m.msBackingStorePixelRatio||m.oBackingStorePixelRatio||m.backingStorePixelRatio||1;q=p/b;"undefined"===typeof a&&(a=!0);a&&p!==b&&(b=e.width,a=e.height,e.width=b*q,e.height=a*q,e.style.width=b+"px",e.style.height=a+"px",m.scale(q,q));m.beginPath();m.arc(d,c,g,0,2*Math.PI,!1);m.closePath();m.fillStyle="#A6A5A1";m.fill();m.lineWidth=2;m.strokeStyle="#fff";m.stroke();return{url:e.toDataURL(),size:h}};a.prototype.hasDataUrl=function(d,a,b){if(null!=a)return null==b&&(b=1),
null==d&&(d="default"),null==this.dataUrls[d]&&(this.dataUrls[d]={}),null!=this.dataUrls[d][a+"-"+b]};a.prototype.getDataUrl=function(d,a,b,e,c){if(null!=e)return null==c&&(c=1),null==b&&(b="default"),null==this.dataUrls[b]&&(this.dataUrls[b]={}),e=e+"-"+c,null==this.dataUrls[b][e]&&(this.dataUrls[b][e]={url:d.toDataURL(),size:a}),this.dataUrls[b][e]};a.prototype.createCanvas=function(d){var a,b;d=d||{};null!=this.data.lat&&null!=this.data.lng&&(b=new google.maps.LatLng(this.data.lat,this.data.lng),
this.data.position=b);a=this.data.content;1E3<a&&(a="999+");this.feature=a=new google.maps.Data.Feature({geometry:b,id:this.data.id,properties:{type:this.data.type,status:this.data.status,marker:this,text:a,range:this.data.range}});b=-1*parseInt(a.getGeometry().get().lat().toFixed(6).replace(".",""));this.data.zIndex=this.data.zIndex||b;(d.shouldShowAllMarkers||"within"===this.data.range)&&this.mapping.dataLayer.add(a);return a};a.prototype.createCanvasLocation=function(){var d,a;d=document.createElement("canvas");
d.width=24;d.height=24;a=d.getContext("2d");a.fillStyle="#fff";a.strokeStyle="#ccc";a.beginPath();a.arc(12,12,12,0,2*Math.PI);a.closePath();a.fill();a.stroke();a.fillStyle="#00a1e5";a.strokeStyle="#fff";a.beginPath();a.arc(12,12,7,0,2*Math.PI);a.closePath();a.fill();a.stroke();return d.toDataURL()};a.prototype.create=function(d){var a,b,e,c;d=d||{};null!=this.data.lat&&null!=this.data.lng&&(e=new google.maps.LatLng(this.data.lat,this.data.lng),this.data.position=e);this.div=$("<div/>").addClass(this.labelClass());
a=this.data.content;1E3<a&&(a="999+");this.div.attr("data-content",a);b={map:this.mapping.map,position:e,content:this.div[0],flat:!0,anchor:8,draggable:null!=this.data.draggable?this.data.draggable:!1,visible:null!=this.data.visible?this.data.visible:!0,wipe:null!=this.data.wipe?this.data.wipe:!0};c=this.override.width||d.width;a=this.override.height||d.height;c&&(b.width=c);a&&(b.height=a);this.marker=new RichMarker(b);this.data.zIndex=-1*parseInt(e.lat().toFixed(6).replace(".",""));this.marker.setZIndex(this.data.zIndex);
d.isIsolated||this.mapping.addMarker(this,this.data.type);return this.setupEvents()};a.prototype.createMarker=function(d,a,b,e){var c,m,p,g;null==b&&(b="#a6007e");null==e&&(e="#ffffff");c=document.createElement("canvas");c.width=2*d;c.height=2*d;m=c.getContext("2d");p=m.measureText(a);g<p.width&&(c.width=p.width);m.fillStyle=b;m.beginPath();m.arc(d,d,d-2,0,2*Math.PI);m.closePath();m.fill();m.lineWidth=2;m.strokeStyle=e;m.stroke();m.fillStyle=e;m.font="bold "+d/1.5+"px Verdana";g=m.measureText(a).width;
m.fillText(a,d-g/2,d+d/1.5/2);this.canvas=c;return c.toDataURL()};a.prototype.labelClass=function(){return this._labelClass.join(" ")};a.prototype.addLabelClass=function(a){this._labelClass.push(a);return this.div.addClass(a)};a.prototype.removeLabelClass=function(a){var b;if(this.hasLabelClass(a))return b=this._labelClass.indexOf(a),this._labelClass.splice(b,1),this.div.removeClass(a)};a.prototype.hasLabelClass=function(a){var b;return null!=(b=-1!==this._labelClass.indexOf(a))?b:{"true":!1}};a.prototype.setPosition=
function(a){return this.marker.setPosition(a)};a.prototype.position=function(){return this.marker.position};a.prototype.setZIndex=function(a){null===a&&(a=this.data.zIndex);return this.marker.setZIndex(a)};a.prototype.setupEvents=function(){if(this.hasLabelClass("events"))return google.maps.event.addListener(this.marker,"mouseover",this.mouseover),google.maps.event.addListener(this.marker,"mouseout",this.mouseout),google.maps.event.addListener(this.marker,"click",this.click)};a.prototype.canvasMouseover=
function(a){a.feature.setProperty("type","highlighted")};a.prototype.canvasMouseout=function(a){a.feature.setProperty("type","normal")};a.prototype.canvasClick=function(a){var b,e;a=a.feature;b=a.getId();"location-marker"!==b&&(e=a.getProperty("units"),1===e?loadUnit(b,-1,!0):loadCluster(b,-1,!0),a.setProperty("type","selected"))};a.prototype.removeEvents=function(){if(this.hasLabelClass("events"))return google.maps.event.clearListeners(this.marker,"mouseover"),google.maps.event.clearListeners(this.marker,
"mouseout"),google.maps.event.clearListeners(this.marker,"click")};a.prototype.mouseover=function(){this.mapping.map.zoom<=this.mapping.defaults.zoom&&this.mapping.neighbourhoods.highlightPolygon(this.data.metadata.neighbourhood);this.addLabelClass("hover");if(!this.hasLabelClass("selected"))return this.setZIndex(1)};a.prototype.mouseout=function(){this.mapping.neighbourhoods.dimPolygon();this.removeLabelClass("hover");if(!this.hasLabelClass("selected"))return this.setZIndex(null)};a.prototype.makeSticky=
function(){return this.marker.bindTo("position",this.mapping.map,"center")};a.prototype.show=function(){this.marker.get("wipe")&&this.marker.set("wipe",!1);this.marker.getVisible()||this.marker.setVisible(!0);return setTimeout(function(a){return function(){return a.addLabelClass("marker-show")}}(this),0)};a.prototype.hide=function(){return this.div.removeClass("marker-show")};a.prototype.wipe=function(){this.marker.set("wipe",!0);return this.marker.setVisible(!1)};a.prototype.destroy=function(){this.hide();
return setTimeout(function(a){return function(){return a.marker.setMap(null)}}(this),this._transitionTime)};a.prototype.updateContent=function(a){return this.div.attr("data-content",a)};return a}()}])},{"../richmarker/richmarker":92}],92:[function(g,h,l){function c(e){var a=e||{};this.dragging_=this.ready_=!1;void 0==e.visible&&(e.visible=!0);void 0==e.shadow&&(e.shadow="7px -3px 5px rgba(88,88,88,0.7)");void 0==e.anchor&&(e.anchor=b.BOTTOM);e.ignoreDragX&&(this.ignoreDragX=e.ignoreDragX);e.ignoreDragY&&
(this.ignoreDragY=e.ignoreDragY);this.setValues(a)}c.prototype="undefined"!=typeof window.google&&google.maps?new google.maps.OverlayView:{};window.RichMarker=c;c.prototype.getVisible=function(){return this.get("visible")};c.prototype.getVisible=c.prototype.getVisible;c.prototype.setVisible=function(b){this.set("visible",b)};c.prototype.setVisible=c.prototype.setVisible;c.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())};
c.prototype.visible_changed=c.prototype.visible_changed;c.prototype.setFlat=function(b){this.set("flat",!!b)};c.prototype.setFlat=c.prototype.setFlat;c.prototype.getFlat=function(){return this.get("flat")};c.prototype.getFlat=c.prototype.getFlat;c.prototype.getWidth=function(){return this.get("width")};c.prototype.getWidth=c.prototype.getWidth;c.prototype.getHeight=function(){return this.get("height")};c.prototype.getHeight=c.prototype.getHeight;c.prototype.setShadow=function(b){this.set("shadow",
b);this.flat_changed()};c.prototype.setShadow=c.prototype.setShadow;c.prototype.getShadow=function(){return this.get("shadow")};c.prototype.getShadow=c.prototype.getShadow;c.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())};c.prototype.flat_changed=c.prototype.flat_changed;c.prototype.setZIndex=function(b){this.set("zIndex",b)};c.prototype.setZIndex=
c.prototype.setZIndex;c.prototype.getZIndex=function(){return this.get("zIndex")};c.prototype.getZIndex=c.prototype.getZIndex;c.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())};c.prototype.zIndex_changed=c.prototype.zIndex_changed;c.prototype.getDraggable=function(){return this.get("draggable")};c.prototype.getDraggable=c.prototype.getDraggable;c.prototype.setDraggable=function(b){this.set("draggable",!!b)};c.prototype.setDraggable=
c.prototype.setDraggable;c.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())};c.prototype.draggable_changed=c.prototype.draggable_changed;c.prototype.getPosition=function(){return this.get("position")};c.prototype.getPosition=c.prototype.getPosition;c.prototype.setPosition=function(b){this.set("position",b)};c.prototype.setPosition=c.prototype.setPosition;c.prototype.position_changed=function(){this.draw()};
c.prototype.position_changed=c.prototype.position_changed;c.prototype.getAnchor=function(){return this.get("anchor")};c.prototype.getAnchor=c.prototype.getAnchor;c.prototype.setAnchor=function(b){this.set("anchor",b)};c.prototype.setAnchor=c.prototype.setAnchor;c.prototype.anchor_changed=function(){this.draw()};c.prototype.anchor_changed=c.prototype.anchor_changed;c.prototype.htmlToDocumentFragment_=function(b){var a=document.createElement("DIV");a.innerHTML=b;if(1==a.childNodes.length)return a.removeChild(a.firstChild);
for(b=document.createDocumentFragment();a.firstChild;)b.appendChild(a.firstChild);return b};c.prototype.removeChildren_=function(b){if(b)for(var a;a=b.firstChild;)b.removeChild(a)};c.prototype.setContent=function(b){this.set("content",b)};c.prototype.setContent=c.prototype.setContent;c.prototype.getContent=function(){return this.get("content")};c.prototype.getContent=c.prototype.getContent;c.prototype.content_changed=function(){if(this.markerContent_){this.removeChildren_(this.markerContent_);var b=
this.getContent();if(b){"string"==typeof b&&(b=b.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),b=this.htmlToDocumentFragment_(b));this.markerContent_.appendChild(b);for(var a=this,b=this.markerContent_.getElementsByTagName("IMG"),d=0,c;c=b[d];d++)google.maps.event.addDomListener(c,"mousedown",function(d){a.getDraggable()&&(d.preventDefault&&d.preventDefault(),d.returnValue=!1)}),google.maps.event.addDomListener(c,"load",function(){a.draw()});google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}};
c.prototype.content_changed=c.prototype.content_changed;c.prototype.setCursor_=function(b){if(this.ready_){var a="";if(-1!==navigator.userAgent.indexOf("Gecko/"))"dragging"==b&&(a="-moz-grabbing"),"dragready"==b&&(a="-moz-grab");else if("dragging"==b||"dragready"==b)a="move";"draggable"==b&&(a="pointer");this.markerWrapper_.style.cursor!=a&&(this.markerWrapper_.style.cursor=a)}};c.prototype.startDrag=function(b){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var a=this.getMap();this.mapDraggable_=
a.get("draggable");a.set("draggable",!1);this.mouseX_=b.clientX;this.mouseY_=b.clientY;this.setCursor_("dragready");this.markerWrapper_.style.MozUserSelect="none";this.markerWrapper_.style.KhtmlUserSelect="none";this.markerWrapper_.style.WebkitUserSelect="none";this.markerWrapper_.unselectable="on";this.markerWrapper_.onselectstart=function(){return!1};this.addDraggingListeners_();google.maps.event.trigger(this,"dragstart")}};c.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=
!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())};c.prototype.drag=function(b){if(this.getDraggable()&&this.dragging_){var a=
this.mouseX_-b.clientX,d=this.mouseY_-b.clientY;this.mouseX_=b.clientX;this.mouseY_=b.clientY;b=parseInt(this.markerWrapper_.style.left,10);var c=parseInt(this.markerWrapper_.style.top,10);this.ignoreDragX||(b-=a,this.markerWrapper_.style.left=b+"px");this.ignoreDragY||(c-=d,this.markerWrapper_.style.top=c+"px");a=this.getOffset_();a=new google.maps.Point(b-a.width,c-a.height);d=this.getProjection();this.setPosition(d.fromDivPixelToLatLng(a));this.setCursor_("dragging");google.maps.event.trigger(this,
"drag")}else this.stopDrag()};c.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_);this.setCursor_("")};c.prototype.addDragging_=function(b){if(b){var a=this;this.draggableListener_=google.maps.event.addDomListener(b,"mousedown",function(d){a.startDrag(d)});this.setCursor_("draggable")}};c.prototype.addDraggingListeners_=function(){var b=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),
this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(a){b.drag(a)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){b.stopDrag();b.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(a){b.drag(a)},!0),google.maps.event.addDomListener(window,"mouseup",function(){b.stopDrag()},!0)]};c.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var b=
0,a;a=this.draggingListeners_[b];b++)google.maps.event.removeListener(a);this.draggingListeners_.length=0}};c.prototype.getOffset_=function(){var e=this.getAnchor();if("object"==typeof e)return e;var a=new google.maps.Size(0,0);if(!this.markerContent_)return a;var d=this.markerContent_.offsetWidth,c=this.markerContent_.offsetHeight;switch(e){case b.TOP:a.width=-d/2;break;case b.TOP_RIGHT:a.width=-d;break;case b.LEFT:a.height=-c/2;break;case b.MIDDLE:a.width=-d/2;a.height=-c/2;break;case b.RIGHT:a.width=
-d;a.height=-c/2;break;case b.BOTTOM_LEFT:a.height=-c;break;case b.BOTTOM:a.width=-d/2;a.height=-c;break;case b.BOTTOM_RIGHT:a.width=-d,a.height=-c}return a};c.prototype.onAdd=function(){this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute");this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex());this.markerWrapper_.style.display=this.getVisible()?"":"none";if(!this.markerContent_){this.markerContent_=document.createElement("DIV");
this.markerWrapper_.appendChild(this.markerContent_);var b=this;google.maps.event.addDomListener(this.markerContent_,"click",function(a){google.maps.event.trigger(b,"click")});google.maps.event.addDomListener(this.markerContent_,"mouseover",function(a){google.maps.event.trigger(b,"mouseover")});google.maps.event.addDomListener(this.markerContent_,"mouseout",function(a){google.maps.event.trigger(b,"mouseout")})}this.ready_=!0;this.content_changed();this.flat_changed();this.draggable_changed();var a=
this.getPanes();a&&a.overlayMouseTarget.appendChild(this.markerWrapper_);google.maps.event.trigger(this,"ready")};c.prototype.onAdd=c.prototype.onAdd;c.prototype.draw=function(){if(this.ready_&&!this.dragging_){var b=this.getProjection();if(b){var a=this.get("position"),b=b.fromLatLngToDivPixel(a),a=this.getOffset_();this.markerWrapper_.style.top=b.y+a.height+"px";this.markerWrapper_.style.left=b.x+a.width+"px";b=this.markerContent_.offsetHeight;a=this.markerContent_.offsetWidth;a!=this.get("width")&&
this.set("width",a);b!=this.get("height")&&this.set("height",b)}}};c.prototype.draw=c.prototype.draw;c.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_);this.removeDragListeners_()};c.prototype.onRemove=c.prototype.onRemove;var b={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};window.RichMarkerPosition=b},{}],42:[function(g,h,l){var c=function(c,a){function d(){this.constructor=
c}for(var f in a)b.call(a,f)&&(c[f]=a[f]);d.prototype=a.prototype;c.prototype=new d;c.__super__=a.prototype;return c},b={}.hasOwnProperty;g("./cluster.f");angular.module("rb-rooms").service("rb-rooms.DevelopmentPreviewService",["rb-rooms.ClusterFactory",function(b){return new (function(a){function b(){return b.__super__.constructor.apply(this,arguments)}c(b,a);b.prototype.url="/-/development-preview";b.prototype.makeSuccess=function(a){return function(b){return function(b,d,c){if(a.success)return a.success(b)}}(this)};
b.prototype.makeError=function(a){return function(b){return function(b,d,c){if(0===d&&null!=a.complete)return a.complete();if(a.error)return a.error(b)}}(this)};return b}(b))}])},{"./cluster.f":40}],40:[function(g,h,l){g("rb-utils/ribs/ribs.s");g("rb-units/models/unit.f");angular.module("rb-rooms").factory("rb-rooms.ClusterFactory",["$http","$window","Ribs","$location","$q","$rootScope",function(c,b,e,a,d,f){return e.Model.extend({url:"/-/search/development",initialize:function(a){a=a||{};return this.model=
this.parseData(a)},parseData:function(b){var d;b=b||{};this.model={};null!=(null!=(d=b.listings)?d[0]:void 0)?this.model.listing_type=b.listings[0].listing_type:this.model.listing_type=a.search().listing_type||"rent";null!=b.development&&(this.model.id=b.development.id,this.model.development=b.development,this.model.count=b.count);return this.model},fetch:function(b,e){var f,m,p,g,q;b=b||{};this.canceler&&(this.canceler.resolve(-1),this.canceler=null);this.canceler=d.defer();f=null!=(null!=(p=b.model)?
p.id:void 0)?b.model.id:this.model.id;if(b.ignoreFilters){if(p={},null!=a.search().rooms==="-1"&&(p.rooms="-1"),null!=b.overrideFilters)for(m in g=b.overrideFilters,g)g=a.search(),null!=g[m]&&(p[m]=g[m])}else p=angular.extend({},a.search());p.page=p.development_page||p.page||1;f=angular.extend({development_id:f},p,b.data);null!=(q=b.model)&&q.useDevelopmentId&&(f.development_id=b.model.id||this.model.id);f.html=this.template||"results";return this.currentFetch=c.get([this.url,f.development_id].join("/"),
{params:f,timeout:this.canceler.promise}).success(this.makeSuccess(b)).error(this.makeError(b))},makeSuccess:function(a){return function(b){return function(d,c,e){b.parseData(d);f.$emit("cluster.fetch.success");a.success&&a.success(d);if(a.complete)return a.complete()}}(this)},makeError:function(a){return function(b){return function(b,d,c){if(0===d&&null!=a.complete)return a.complete();a.error&&a.error(b);if(a.complete)return a.complete()}}(this)}})}])},{"rb-units/models/unit.f":152,"rb-utils/ribs/ribs.s":194}],
152:[function(g,h,l){g("rb-utils/ribs/ribs.s");angular.module("rb-rooms").factory("rb-rooms.UnitFactory",["$http","$window","Ribs",function(c,b,e){var a;a=e.Model.extend({url:"/-/listings",initialize:function(b){b=b||{};null==b.attributes&&(b.attributes={});this.model=b;return this.STATES=a.STATES},canonicalUrl:function(){null==b.location.origin&&(b.location.origin=b.location.protocol+"//"+b.location.host);return b.location.origin+"/listings/"+this.get("id")},parseOutput:function(a){var b,c,e;null!=
(null!=(b=a.location)?null!=(c=b.development)?c.id:void 0:void 0)&&(a.location.development=a.location.development.id);null!=(null!=(e=a.user)?e.id:void 0)&&(a.user=a.user.id);return a},isActive:function(){return this.model.status===this.STATES.ACTIVE},isDraft:function(){return this.model.status===this.STATES.DRAFT||null==this.model.status},isPending:function(){return this.model.status===this.STATES.PENDING},isExpired:function(){return this.model.status===this.STATES.EXPIRED},isInactive:function(){return this.model.status===
this.STATES.INACTIVE},isClosed:function(){return this.model.status===this.STATES.CLOSED},isRejected:function(){return this.model.status===this.STATES.REJECTED},isApproved:function(){return this.model.status!==this.STATES.DRAFT&&this.model.status!==this.STATES.PENDING&&this.model.status!==this.STATES.REJECTED},isComplete:function(){return this.model.status!==this.STATES.DRAFT},requiresDevelopment:function(){return"condo"===this.model.main_category&&"walkup"!==this.model.sub_category&&"condo_apartment"!==
this.model.sub_category},getLister:function(a){a&&(this.model=a);if(null==this.model)return null;if(!this.model.unverified_owner&&!this.model.user)return{};if(!this.model.unverified_owner&&this.model.user)return this.model.user;if(this.model.unverified_owner&&!this.model.user)return this.model.unverified_owner},isListerAgent:function(a){var b,c,e;a&&(this.model=a);return this.model?null!=(null!=(b=this.model.unverified_owner)?b.agent_number:void 0)||null!=(null!=(c=this.model.user)?null!=(e=c.agent)?
e.agent_number:void 0:void 0)?!0:!1:null}});a.STATES={DRAFT:"draft",PENDING:"pending",REJECTED:"rejected",INACTIVE:"inactive",ACTIVE:"active",EXPIRED:"expired",DELETED:"deleted",CLOSED:"closed"};a.MAIN_CATEGORIES={HDB:"hdb",CONDO:"condo",LANDED:"landed"};a.LISTING_TYPES={RENTALS:"rent",SALES:"sale"};a.SUB_CATEGORIES={hdb:["2 room (1 BR)","3 room (2 BR)","4 room (3 BR)","5 room (3 BR)","Executive (4+ BR)"],condo:["Condominium","Apartment","Walk up","Executive Condominium"],landed:"Terrace House;Corner Terrace;Semi Detached;Bungalow House;Good Class Bungalow;Shophouse;Conservation House;Town House;Land Only;Cluster House".split(";")};
a.SUB_CATEGORIES_DICT={hdb:{hdb_2r:"2 room (1 BR)",hdb_3r:"3 room (2 BR)",hdb_4r:"4 room (3 BR)",hdb_5r:"5 room (3 BR)",hdb_executive:"Executive (4+ BR)"},condo:{generic_condo:"Condominium",condo_apartment:"Apartment",walkup:"Walk up",executive_condo:"Executive Condominium"},landed:{terraced_house:"Terrace House",corner_terrace:"Corner Terrace",semi_detached:"Semi Detached",bungalow:"Bungalow House",goodclass_bungalow:"Good Class Bungalow",shophouse:"Shophouse",conservationhouse:"Conservation House",
townhouse:"Town House",landonly:"Land Only",landedcluster:"Cluster House"}};a.AMENITIES={full:["bed","dining room furniture","couch","closets"],partial:["aircon","fridge","washer","stove"],condo:"playground;gym;swimming pool;parking;basketball court;tennis court;squash court;badminton hall;sauna;bbq pits;mini-mart;fibre ready".split(";"),unit:"aircon;fridge;washer;stove;bed;dining room furniture;couch;closets;dryer;bathtub;tv;audio system;dishwasher;maid's room;bombshelter;balcony".split(";"),names:{pool_available:"swimming pool",
washer_available:"washer",dryer_available:"dryer",gym_available:"gym",parking_available:"car park"},floor:["high floor","middle floor","low floor","ground floor","penthouse"]};return a}])},{"rb-utils/ribs/ribs.s":194}],197:[function(g,h,l){Spinner=g("./../../../bower_components/spin.js/dist/spin.min.js");angular.module("rb-utils").directive("spinning",[function(){return{restrict:"A",link:function(c,b,e){var a,d,f,k;k={color:"#ffffff",lines:12,radius:5,length:5,width:3,zIndex:"initial",top:"auto",
left:"auto",className:"spinner"};e.spOptions&&angular.extend(k,c.$eval(e.spOptions));f=new Spinner(k);a=document.createElement("div");a.className="ladda-spinner";b.append(a);c.$watch(e.spinning,function(c,e){if(null===c)return!1;c?(clearTimeout(d),f.spin(a),b.addClass("loading")):(b.removeClass("loading"),clearTimeout(d),d=setTimeout(function(){f.stop()},1E3));return this})}}}])},{"./../../../bower_components/spin.js/dist/spin.min.js":26}],26:[function(g,h,l){(function(c,b){"object"==typeof l?h.exports=
b():"function"==typeof define&&define.amd?define(b):c.Spinner=b()})(this,function(){function c(a,b){var d=document.createElement(a||"div"),c;for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,d=arguments.length;b<d;b++)a.appendChild(arguments[b]);return a}function e(a,b,d,c){var e=["opacity",b,~~(100*a),d,c].join("-");d=.01+d/c*100;c=Math.max(1-(1-a)/b*(100-d),a);var f=q.substring(0,q.indexOf("Animation")).toLowerCase();w[e]||(h.insertRule("@"+(f&&"-"+f+"-"||"")+"keyframes "+e+"{0%{opacity:"+
c+"}"+d+"%{opacity:"+a+"}"+(d+.01)+"%{opacity:1}"+(d+b)%100+"%{opacity:"+a+"}100%{opacity:"+c+"}}",h.cssRules.length),w[e]=1);return e}function a(a,b){var d=a.style,c,e;b=b.charAt(0).toUpperCase()+b.slice(1);for(e=0;e<p.length;e++)if(c=p[e]+b,void 0!==d[c])return c;if(void 0!==d[b])return b}function d(b,d){for(var c in d)b.style[a(b,c)||c]=d[c];return b}function f(a){for(var b=1;b<arguments.length;b++){var d=arguments[b],c;for(c in d)void 0===a[c]&&(a[c]=d[c])}return a}function k(a){for(var b={x:a.offsetLeft,
y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function r(a){if("undefined"==typeof this)return new r(a);this.opts=f(a||{},r.defaults,l)}function m(){function a(b,d){return c("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',d)}h.addRule(".spin-vml","behavior:url(#default#VML)");r.prototype.lines=function(c,e){function f(){return d(a("group",{coordsize:p+" "+p,coordorigin:-r+" "+-r}),{width:p,height:p})}
function k(c,p,m){b(q,b(d(f(),{rotation:360/e.lines*c+"deg",left:~~p}),b(d(a("roundrect",{arcsize:e.corners}),{width:r,height:e.width,left:e.radius,top:-e.width>>1,filter:m}),a("fill",{color:g(e.color,c),opacity:e.opacity}),a("stroke",{opacity:0}))))}var r=e.length+e.width,p=2*r,m=2*-(e.width+e.length)+"px",q=d(f(),{position:"absolute",top:m,left:m});if(e.shadow)for(m=1;m<=e.lines;m++)k(m,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(m=1;m<=e.lines;m++)k(m);
return b(c,q)};r.prototype.opacity=function(a,b,d,c){a=a.firstChild;c=c.shadow&&c.lines||0;a&&b+c<a.childNodes.length&&(a=(a=(a=a.childNodes[b+c])&&a.firstChild)&&a.firstChild)&&(a.opacity=d)}}var p=["webkit","Moz","ms","O"],w={},q,h=function(){var a=c("style",{type:"text/css"});b(document.getElementsByTagName("head")[0],a);return a.sheet||a.styleSheet}(),l={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2E9,className:"spinner",
top:"auto",left:"auto",position:"relative"};r.defaults={};f(r.prototype,{spin:function(a){this.stop();var b=this,e=b.opts,f=b.el=d(c(0,{className:e.className}),{position:e.position,width:0,zIndex:e.zIndex}),r=e.radius+e.length+e.width,p,m;a&&(a.insertBefore(f,a.firstChild||null),m=k(a),p=k(f),d(f,{left:("auto"==e.left?m.x-p.x+(a.offsetWidth>>1):parseInt(e.left,10)+r)+"px",top:("auto"==e.top?m.y-p.y+(a.offsetHeight>>1):parseInt(e.top,10)+r)+"px"}));f.setAttribute("role","progressbar");b.lines(f,b.opts);
if(!q){var g=0,x=(e.lines-1)*(1-e.direction)/2,w,h=e.fps,l=h/e.speed,I=(1-e.opacity)/(l*e.trail/100),J=l/e.lines;(function aa(){g++;for(var a=0;a<e.lines;a++)w=Math.max(1-(g+(e.lines-a)*J)%l*I,e.opacity),b.opacity(f,a*e.direction+x,w,e);b.timeout=b.el&&setTimeout(aa,~~(1E3/h))})()}return b},stop:function(){var a=this.el;a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0);return this},lines:function(a,f){function k(a,b){return d(c(),{position:"absolute",width:f.length+
f.width+"px",height:f.width+"px",background:a,boxShadow:b,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*p+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var p=0,r=(f.lines-1)*(1-f.direction)/2,m;p<f.lines;p++)m=d(c(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:q&&e(f.opacity,f.trail,r+p*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(m,d(k("#000","0 0 4px #000"),
{top:"2px"})),b(a,b(m,k(g(f.color,p),"0 0 1px rgba(0,0,0,.1)")));return a},opacity:function(a,b,d){b<a.childNodes.length&&(a.childNodes[b].style.opacity=d)}});var v=d(c("group"),{behavior:"url(#default#VML)"});!a(v,"transform")&&v.adj?m():q=a(v,"animation");return r})},{}],186:[function(g,h,l){g("rb-track/tracker/tracker.s");angular.module("rb-rooms").directive("viewModal",["$rootScope","$filter","rb-utils.tracker",function(c,b,e){return{templateUrl:"modal.tpl.html",restrict:"A",replace:!1,scope:!0,
link:function(a,b,e){var k,g,r,m,p,w;w=["name","template","title","mdTitle"];m={};k=0;for(r=w.length;k<r;k++)p=w[k],m[p]=e[p];m.mdTitle&&(m.title=m.mdTitle);g=e.key;g="modal";a[g]=m;$(b).find(".close").on("click",function(){a[g].close();return!0});a.$on("show-modal",function(e,f,k){null!=k&&null!=f.name&&(e=k.name||f.name,delete k.name,c.$emit("Show "+e,k));if(null!=f.name&&a[g].name===f.name)return a[g].show(),$(b).off("shown.bs.modal"),$(b).on("shown.bs.modal",function(){var b;return null!=f.cb?
(b=f.data||{},f.cb(b)):a.$emit("shown-modal",f)}),$(b).off("hidden.bs.modal"),$(b).on("hidden.bs.modal",function(){return a.$emit("close-modal",f)})});a[g].close=function(){$(b).find("#"+a[g].name).modal("hide");return!0};return a[g].show=function(){$(b).find("#"+a[g].name).modal("show");return!0}}}}])},{"rb-track/tracker/tracker.s":130}],29:[function(g,h,l){h=g("./angular-modules");g("rb-core/rb-core");g("./angular-common");angular.module("roomboom",h).config(["$locationProvider",function(c){return c.html5Mode(!0)}]).config(["$sceDelegateProvider",
function(c){return c.resourceUrlWhitelist(["self","^https://99-(sg|unit)media(-dev)?.s3.amazonaws.com/.*",/^https:\/\/www\.youtube\.com\/.*/])}]).run(["$rootScope","$location","rb-core.TEST",function(c,b,e){c=b.path();c=/^\/search/i.test(c)?2E4:1E4;return setTimeout(function(){if(!e)return $("<script>").attr("type","text/javascript").text("window.$zopim||(function(d,s){var z=$zopim=function(c){z._.push(c)},$=z.s=d.createElement(s),e=d.getElementsByTagName(s)[0];z.set=function(o){z.set._.push(o)};z._=[];z.set._=[];$.async=!0;$.setAttribute('charset','utf-8');$.src='//v2.zopim.com/?1TB0FWBHkZILzuJVmLcaQLpVLYE0xarD';z.t=+new Date;$.type='text/javascript';e.parentNode.insertBefore($,e)})(document,'script');").appendTo("head")},
c)}])},{"./angular-common":28,"./angular-modules":30,"rb-core/rb-core":46}],46:[function(g,h,l){g("rb-utils/browser-fixer/browser-fixer");angular.module("rb-core",["$browserFixer","ngSanitize","ivpusic.cookie"]).factory("libs.moment",[function(){return moment?moment:new Date}]).config(["$httpProvider","$provide","$interpolateProvider",function(c,b,e){var a;e.startSymbol("{!");e.endSymbol("!}");e={VERSION:"1.0.1",PLATFORM:"Web",USER_AGENT:"",TEST:window.Roomboom.debug,NINE_AGENT:"",APP:"rb"};window&&
window.navigator&&(e.USER_AGENT=window.navigator.userAgent);e.NINE_AGENT=[e.PLATFORM,e.VERSION,e.USER_AGENT].join("/");c.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";c.defaults.headers.common["X-99-Agent"]=e.NINE_AGENT;for(a in e)b.value(["rb-core",a].join("."),e[a]);if(!e.TEST)return console.log=function(){},console.debug=function(){},console.warning=function(){},console.warn=function(){}}])},{"rb-utils/browser-fixer/browser-fixer":173}],173:[function(g,h,l){angular.module("$browserFixer",
[]).config(["$provide",function(c){c.decorator("$browser",["$delegate",function(b){b.superUrl=b.url;b.url=function(){if(0<arguments.length)return this.superUrl.apply(this,arguments);var b;b=this.superUrl();var a=b.indexOf("?");if(!(0>a)){var d=b.substring(0,a),c=b.substring(a);if(!(0>c.indexOf("+"))){var k="",g=b.indexOf("#");g>a&&(c=b.substring(a,g),k=b.substring(g));c=c.replace(/\+/g,"%20");b=d+c+k}}return b};return b}])}])},{}],30:[function(g,h,l){var c,b,e;g="rb-core roomboom-templates rb-utils rb-rooms rb-users rb-main rb-facebook rb-feedback rb-neighbourhoods rb-photos rb-ui rb-agent rb-mrts rb-search rb-cluster rb-map".split(" ");
l=["ngCookies","ngProgress","selectize"];b=0;for(e=g.length;b<e;b++){c=g[b];try{angular.module(c)}catch(a){angular.module(c,[])}}c=0;for(b=l.length;c<b;c++){e=l[c];try{angular.module(e)}catch(d){angular.module(e,[])}}h.exports=g.concat(l)},{}],28:[function(g,h,l){g("rb-header/rb-header");window.moment=g("./../../bower_components/moment/min/moment.min");g("./../../bower_components/angular-cookie/angular-cookie.min");g("./../../bower_components/angular-sanitize/angular-sanitize.min");g("rb-track/tracker/tracker.s");
g("rb-utils/user-initialize/user-initialize.d")},{"./../../bower_components/angular-cookie/angular-cookie.min":18,"./../../bower_components/angular-sanitize/angular-sanitize.min":19,"./../../bower_components/moment/min/moment.min":23,"rb-header/rb-header":56,"rb-track/tracker/tracker.s":130,"rb-utils/user-initialize/user-initialize.d":199}],199:[function(g,h,l){g("rb-user/user/user.s");angular.module("rb-utils").directive("rutUserInitialize",["$window","rb-users.user",function(c,b){return{restrict:"A",
link:function(e,a,d){if($.isEmptyObject(c.Roomboom.user))return $(document).on("initialize-user-model",function(a,d){return b.set(d)})}}}])},{"rb-user/user/user.s":169}],130:[function(g,h,l){g("./tracker");g("./track.d");g("rb-user/user/user.s");g("rb-utils/cookie-storage/cookie-storage.s");angular.module("rb-utils").run(["$rootScope","rb-utils.tracker",function(c,b){return c.tracker=b}]).service("rb-utils.tracker",["$FB","$window","$rootScope","rb-users.user","libs.moment","rb-core.TEST","rb-utils.CookieStorage",
function(c,b,e,a,d,f,k){var g,r,m;m=function(a,b){return(new Image(1,1)).src="//www.googleadservices.com/pagead/conversion/"+a+"/?label="+b};r=function(a,b){return(new Image(1,1)).src="//www.facebook.com/tr?ev="+a+"&amp;cd[value]="+b+"&amp;cd[currency]=SGD"};g=function(){var d;if(!f&&null!=(null!=(d=a.model)?d.email:void 0)&&/.+@(billpin\.com|homie\.co|99\.co)/.test(a.model.email))return b.mixpanel.register({$ignore:!0})};e.$on("fb.loaded",function(){c.Event.subscribe("edge.create",function(a){return this.trackFB("Liked",
a)});c.Event.subscribe("edge.remove",function(a){return this.trackFB("Unliked",a)});return c.Event.subscribe("message.send",function(a){return this.trackFB("Sent",a)})});e.$on("fb.share",function(c){return function(e,f,k){a.model.id&&(b.mixpanel.people.increment({"Shares Count":1}),b.mixpanel.people.set({"Shares Last Seen":d.utc().format()}));return c.trackFB("Shared",f,k)}}(this));e.$on("logged-in",function(c){return function(){var e;a.model.id&&(b.mixpanel.identify(a.model.id),b.mixpanel.register({"User ID":a.model.id||
""}),b.mixpanel.people.set({"User ID":a.model.id||""}),b.mixpanel.people.increment({"Log In Count":1}),b.mixpanel.people.set({"Log In Last Seen":d.utc().format()}),b.ga("set","user_id",a.model.id),b.ga("set","&uid",a.model.id),e=a.model.age?a.model.age:"",b.mixpanel.register({Age:e}),b.mixpanel.people.set({Age:e}),e="","male"===a.model.gender?e="Male":"female"===a.model.gender&&(e="Female"),b.mixpanel.register({Gender:e}),b.mixpanel.people.set({Gender:e}));a.model.first_name&&a.model.last_name&&(e=
a.model.first_name+" "+a.model.last_name,b.mixpanel.register({$name:e,$first_name:a.model.first_name,$last_name:a.model.last_name}),b.mixpanel.people.set({$name:e,$first_name:a.model.first_name,$last_name:a.model.last_name}),b.ga("set","name",e));a.model.email&&(b.mixpanel.register({$email:a.model.email}),b.mixpanel.people.set({$email:a.model.email}));return c.track("User Logged In")}}(this));e.$on("user.shortlist.updated",function(d){return function(c,e,f){a.model.id&&(b.mixpanel.register({Shortlisted:"TRUE"}),
b.mixpanel.people.set({Shortlisted:"TRUE"}));return d.track("Shortlist Submitted",{method:e,unit:f})}}(this));e.$on("user.schedule.updated",function(d){return function(c,e,f){a.model.id&&(b.mixpanel.register({Scheduled:"TRUE"}),b.mixpanel.people.set({Scheduled:"TRUE"}));return d.track("Schedule Viewing Request Submitted",{schedule:e,unit:f})}}(this));e.$on("enquiry.submitted",function(b){return function(d,c,e){var f;d=0;b.track("Send Enquiry Submitted",{enquiry:c,unit:e});c=a.model.shortlisted_units;
for(f in c)e=c[f],null!=(null!=e?e.enquired:void 0)&&d++;if(1>=d)return m(960169701,"sok3CP20_FcQ5Y3syQM"),r(6030268140076,0)}}(this));e.$on("enquiry.submitted.nonUser",function(a){return function(b,d,c){var e;b=0;a.track("Send Enquiry Submitted",{enquiry:d,unit:c});d=k.get("enquiredUnits");for(e in d)c=d[e],null!=(null!=c?c.enquired:void 0)&&b++;if(1>=b)return m(960169701,"sok3CP20_FcQ5Y3syQM"),r(6030268140076,0)}}(this));e.$on("user.requirements.submit",function(a){return function(b,d){return a.track("Rental Requirements Submitted",
{requirements:d})}}(this));e.$on("successful-signup",function(a){return function(b,d){return a.track("Submitted Sign Up",{Action:d})}}(this));e.$on("search-autocomplete-place-selected",function(a){return function(b,d){return a.track("Search Autocomplete Place Selected",{datum:d})}}(this));e.$on("user.requirements.update",function(a){return function(b,d){return a.track("Rental Requirements Updated",{requirements:d})}}(this));e.$on("search.filters.submitted",function(a){return function(b,d){return a.track("Submitted Search Filters",
{data:d})}}(this));e.$on("map.fetched",function(a){return function(b,d){return a.track("Loaded New Map",{data:d})}}(this));e.$on("Show Login",function(a){return function(b,d){return a.track("Login Prompt Shown",d)}}(this));e.$on("Show Requirements",function(a){return function(b,d){return a.track("Rental Requirements Shown",d)}}(this));e.$on("Show Schedule",function(a){return function(b,d){return a.track("Schedule Prompt Shown",d)}}(this));e.$on("phone.show",function(a){return function(b,d){return a.track("Clicked Show Phone Number",
d)}}(this));this.track=function(a){return function(a,d){d=d||{};if(b.tracker)return b.tracker.track(a,d)}}(this);this.mpTrack=function(a){return function(a,d){d=d||{};if(b.tracker)return b.tracker._mp(a,d)}}(this);this.trackFB=function(a){return function(a,d,e){if(b.tracker)return d={url:d,fbuid:c.getUserID()},e&&(d.post_id=e),b.tracker.track("Facebook "+a,d)}}(this);(function(){var b;"undefined"!==typeof mixpanel&&null!==mixpanel&&(g(),null==(null!=(b=a.model)?b.email:void 0)&&e.$on("logged-in",
function(){return g()}),mixpanel.register({"Page Name":location.pathname}),mixpanel.register({URL:location.pathname}),a.model.id&&mixpanel.people.increment({"Page View Count":1}));return tracker.track("Page Loaded")})();return this}])},{"./track.d":128,"./tracker":129,"rb-user/user/user.s":169,"rb-utils/cookie-storage/cookie-storage.s":175}],169:[function(g,h,l){g("./user.f");g("rb-facebook/facebook.f");g("rb-units/models/manage.f");g("rb-units/shortlist/shortlist.f");g("rb-agent/agent/agent.f");
g("rb-utils/ribs/ribs.s");angular.module("rb-users").service("rb-users.user",["rb-users.User","rb-users.FacebookFactory","rb-rooms.ShortlistFactory","rb-users.AgentFactory","rb-rooms.ManageFactory","Ribs","$window",function(c,b,e,a,d,f,k){c=new c(k.Roomboom.user);return c=f.equip(c,{facebook:b,shortlist:e,agent:a,manage:d})}])},{"./user.f":168,"rb-agent/agent/agent.f":31,"rb-facebook/facebook.f":52,"rb-units/models/manage.f":151,"rb-units/shortlist/shortlist.f":161,"rb-utils/ribs/ribs.s":194}],168:[function(g,
h,l){g("rb-utils/ribs/ribs.s");angular.module("rb-users").factory("rb-users.User",["$http","$window","Ribs",function(c,b,e){var a;return a=e.Model.extend({url:"/-/user",initialize:function(a){this.model=a;return this.TYPES={NORMAL:0,AGENT:1,LANDLORD:2,RENTER:4,JARVIS:8}},save:function(b){var c;c={shortlist:this.model.shortlisted_units,shortlisted_units_id:this.model.shortlisted_units_id,shortlisted_clusters_id:this.model.shortlisted_clusters_id};delete this.model.shortlisted_units;delete this.model.shortlisted_units_id;
delete this.model.shortlisted_clusters_id;return a.__super__.save.call(this,b).then(function(a){return function(){return a.restore(c)}}(this),function(a){return function(){return a.restore(c)}}(this))},restore:function(a){return this.model=angular.extend(this.model,a)}})}])},{"rb-utils/ribs/ribs.s":194}],161:[function(g,h,l){var c=[].indexOf||function(b){for(var c=0,a=this.length;c<a;c++)if(c in this&&this[c]===b)return c;return-1};g("rb-utils/ribs/ribs.s.js");g("rb-utils/cookie-storage/cookie-storage.s.coffee");
angular.module("rb-rooms").factory("rb-rooms.ShortlistFactory",["$FB","$http","$window","$timeout","$rootScope","Ribs","rb-utils.CookieStorage",function(b,e,a,d,f,k,g){return k.Model.extend({initialize:function(a,b){this.api=a;this.owner=b;this.initEvents();if(!this.owner.get("account_active"))return this.tempUserShortlist=g.get("shortlists")},initEvents:function(){var a;return null!=(a=this.owner.model)&&a.account_active?this.buildArrays():f.$on("logged-in",function(a){return function(){return a.buildArrays()}}(this))},
save:function(a){var b,d,c,k,h,l,v,u,y,A;k=a.item;if(this.owner.get("account_active"))return c={},c.id=k.id,u=this.getUrl(k),l=this.getArrayNames(k),b=l[0],h=this.isShortlisted(k)?"DELETE":"POST",e({method:h,url:u,data:c}).success(function(c){return function(e,g,x,l){e=e.model||e;"POST"===h?(null!=e[k.id]&&angular.extend(e[k.id],k),c.owner.get(b)[k.id]=e[k.id]):"DELETE"===h&&(delete c.owner.get(b)[k.id],v=!0);c.destoyBuiltArrays();k.cluster_id&&(d=k.cluster_id);a.clusterId&&(d=a.clusterId);d&&f.$emit("user.shortlist.updated",
h,k.id,d,v);if(a.success)return a.success(e,g,x,l)}}(this)).error(function(b){return function(b,d,c,e){if(a.error)return a.error(b,d,c,e)}}(this));A=k.id;y=g.get("shortlists");c=g.get("shortlistedMarkers");k.cluster_id&&(d=k.cluster_id);a.clusterId&&(d=a.clusterId);l=Roomboom.user.shortlisted_units;u=Roomboom.user.shortlisted_units_id;void 0===y[A]?(void 0!==u&&(0===u.length&&f.$emit("shortlist.exist"),u.push(A)),void 0!==l&&(l[A]=k),y[A]=!0,void 0===c[d]&&(c[d]=!0)):(delete y[A],void 0!==l&&delete l[A],
void 0!==u&&(u.splice(u.indexOf(A),1),0===u.length&&f.$emit("shortlist.noExist")),c[d]&&(delete c[d],v=!0));g.put("shortlistedMarkers",c);g.put("shortlists",y);f.$emit("nonUser.shortlist.updated",d,v);f.$emit("update.shortlists");return a.success()},isShortlisted:function(a){var b,d,e;if(this.owner.get("account_active")){if(this.buildArrays(),d=this.getArrayNames(a),b=d[1],d=d[2],this.owner.get(b))return e=a[d],0<=c.call(this.owner.get(b),e)}else return!!this.tempUserShortlist[a.id];return!1},mergeSchedule:function(a){var b,
d,c,e;if(null==a)return console.error("[error Shortlist.f] mergeSchedule received no data!");b=this.owner.get("shortlisted_units");d=[];for(e in a)c=a[e],null!=b[e]?d.push(b[e]=angular.extend(b[e],c)):d.push(void 0);return d},buildArrays:function(){if(!this.shortlistArrays)return this.buildUnitArray(),this.buildClusterArray(),this.shortlistArrays=!0},buildUnitArray:function(){var a,b,d,c;a=this.getArrayNames({address:!0});b=a[0];d=a[1];a=[];if(null!=this.owner.get(b))for(c in b=this.owner.get(b),
b)a.push(c);return this.owner.set(d,a)},buildClusterArray:function(){var a,b,d,e,f,k,g;k=this.getArrayNames({coordinates:!0})[1];b=this.getArrayNames({address:!0})[0];a=[];if(null!=this.owner.get(b))for(f in b=this.owner.get(b),b)for(e in d=b[f],g=d.clusters,g)d=g[e],0>c.call(a,d)&&a.push(d);return this.owner.set(k,a)},destoyBuiltArrays:function(){var a;a=this.getArrayNames({coordinates:!0});this.owner.set(a[1],void 0);a=this.getArrayNames({address:!0});this.owner.set(a[1],void 0);return this.shortlistArrays=
!1},getArrayNames:function(a){var b,d;this.isUnit(a)?(b="shortlisted_units",d="id"):this.isCluster(a)&&(b="shortlisted_clusters",d="id");return[b,b+"_"+d,d]},getUrl:function(a){var b;this.isUnit(a)?b="/units/"+a.id+"/shortlist":this.isCluster(a)&&(b="/units/cluster/"+a.id+"/shortlist");return b},isUnit:function(a){if(null==a)return!1;if(null!=a.address||null!=a.rooms)return!0},isCluster:function(a){if(null==a)return!1;if(null!=a.lat&&null!=a.lng||null!=a.coordinates&&!a.rooms)return!0},getState:function(a){return this.isShortlisted(a)}})}]).service("rb-rooms.ShortlistService",
["$http","$window","$rootScope","Ribs","rb-utils.CookieStorage",function(b,c,a,d,f){return new (d.Model.extend({initialize:function(){this.shortlistUrl="/-/shortlist-listing";return this.unshortlistUrl="/-/unshortlist-listing"},shortlist:function(a){return b.post(this.shortlistUrl,a.data).success(function(b){if(a.success)return a.success(b)}).error(function(b){if(a.error)return a.error(b)})},unshortlist:function(a){return b.post(this.unshortlistUrl,a.data).success(function(b){if(a.success)return a.success(b)}).error(function(b){if(a.error)return a.error(b)})}}))}])},
{"rb-utils/cookie-storage/cookie-storage.s.coffee":175,"rb-utils/ribs/ribs.s.js":194}],175:[function(g,h,l){angular.module("rb-utils").service("rb-utils.CookieStorage",["ipCookie",function(c){var b;b=c("rb");null==b&&c("rb",{},{path:"/"});return{get:function(e){b=c("rb");null==b[e]&&(b[e]={});return b[e]},put:function(e,a){b=c("rb");b[e]=a;return c("rb",b,{path:"/"})}}}])},{}],151:[function(g,h,l){g("rb-utils/ribs/ribs.s");angular.module("rb-rooms").factory("rb-rooms.ManageFactory",["$http","$window",
"Ribs",function(c,b,e){return e.Model.extend({initialize:function(a,b,c){this.api=a;this.owner=b;return this.manageBase=this.owner.url||"/-/listings"},initializePermissions:function(a){if(null!=this.owner.get("fbuid"))return this.getAuthToken()},deactivate:function(a,b){var e;e=[this.manageBase,this.owner.get("id"),"deactivate"].join("/");return c.post(e,a).success(function(a){return function(c,e,f){a.owner.set(c.model||c);if(b.success)return b.success(c)}}(this)).error(function(a){return function(a,
c,e){if(b.error)return b.error(a)}}(this))},del:function(a,b){var e;b=b||{};e=[this.manageBase,this.owner.get("id"),"delete"].join("/");return c["delete"](e,{data:a}).success(function(a){return function(c,e,f){a.owner.set(c.model||c);if(b.success)return b.success(c)}}(this)).error(function(a){return function(a,c,e){if(b.error)return b.error(a)}}(this))}})}])},{"rb-utils/ribs/ribs.s":194}],52:[function(g,h,l){var c,b;b=g("rb-vanilla-login/app");c=g("rb-vanilla-login/facebook_sdk");g("rb-utils/ribs/ribs.s");
g("./rb-facebook");angular.module("rb-users").factory("rb-users.FacebookFactory",["$http","$rootScope","$FB","Ribs",function(e,a,d,f){return f.Model.extend({initialize:function(b,d){this.api=b;this.owner=d;this.linkUrl="/-/facebook-connect";this.graphUrl="https://graph.facebook.com/";this.mutualFriends={};this.authResponse=null;this.permissions=["email","user_location"];return a.$on("fb.loaded",function(a){return function(b){return a.initializePermissions(b)}}(this))},initializePermissions:function(a){if(null!=
this.owner.get("fbuid"))return this.getAuthToken()},usingFacebookPhoto:function(){return null!=this.owner.model.profile_pic&&-1===this.owner.model.profile_pic.indexOf(this.graphUrl)},useProfilePhoto:function(){return this.owner.set({profile_pic:this.graphUrl+this.owner.model.fbuid+"/picture"})},connect:function(d){return c.checkFbLoginState(function(c){return b.send("/-/facebook-connect",JSON.stringify(c),"post",function(b){a.$emit("logged-in");if(d.success)return d.success(b)})})},getAuthToken:function(b,
c,e){return d.getLoginStatus(function(d){return function(c){var f,g;if("connected"===c.status){if(d.authResponse=c.authResponse,g=c.authResponse.userID,f=c.authResponse.accessToken,a.$emit("fb.authenticated",c.authResponse),a.$$phase||a.$apply(),null!=b)return b(g,f)}else if(null!=e)return e()}}(this))},hasMutual:function(a){return null!=this.mutualFriends[a]&&0<this.mutualFriends[a].length},getMutual:function(a){return this.mutualFriends[a]},share:function(b,c,e){var f;f={method:"feed",link:b};f=
angular.extend(f,e);return d.ui(f,function(d){d&&d.post_id&&a.$broadcast("fb.share",b,d.post_id);return c(d)})}})}])},{"./rb-facebook":53,"rb-utils/ribs/ribs.s":194,"rb-vanilla-login/app":201,"rb-vanilla-login/facebook_sdk":203}],53:[function(g,h,l){angular.module("rb-facebook").directive("fb",["$FB",function(c){return{restrict:"EA",replace:!0,template:'<div id="fb-root"></div>',compile:function(b,e){return{post:function(a,b,e,k){a=e.appId;var g={appId:e.appId||"",cookie:e.cookie||!0,status:e.status||
!0,xfbml:e.xfbml||!0,channelUrl:"//"+document.domain+":"+location.port+"/static/d/channel.html"};window.fbAsyncInit=function(){c._init(g);"fbInit"in e&&e.fbInit()};(function(a,b,d,c){c=a.getElementsByTagName(b)[0];a.getElementById(d)||(a=a.createElement(b),a.id=d,a.async=!0,a.src="//connect.facebook.net/en_US/all.js",c.parentNode.insertBefore(a,c))})(document,"script","facebook-jssdk",a)}}}}}]).factory("$FB",["$rootScope",function(c){var b={loaded:!1,_init:function(e){window.FB&&(angular.extend(window.FB,
b),angular.extend(b,window.FB),b.loaded=!0,window.FB.init(e),c.$emit("fb.loaded"),c.$$phase||c.$apply())}};return b}])},{}],31:[function(g,h,l){g("rb-utils/ribs/ribs.s");angular.module("rb-users").factory("rb-users.AgentFactory",["$FB","$http","$window","$rootScope","Ribs",function(c,b,e,a,d){return d.Model.extend({AGENT_TYPES:{NORMAL:0,PARTNER:1},initialize:function(a,b){this.api=a;this.owner=b;return this.baseUrl="/-/agent-verification"},verify:function(d,c,e){null!=d&&(d=d.toUpperCase());return b.post(this.baseUrl,
{cea:d,phone:c}).success(function(b,d,c,f){a.$emit("user.agent.checked",b);if(e.success)return e.success(b,d,c,f)}).error(function(a,b,d,c){if(e.error)return e.error(a,b,d,c)})},isAgent:function(){return this.owner.get("agent")},isLandlord:function(){return(this.owner.get("type")&this.owner.TYPES.LANDLORD)===this.owner.TYPES.LANDLORD},isJarvis:function(){return(this.owner.get("type")&this.owner.TYPES.JARVIS)===this.owner.TYPES.JARVIS},canList:function(){return this.owner.get("phone")},getLister:function(a){if(null==
a)return null;if(!a.unverified_owner&&!a.user)return{};if(!a.unverified_owner&&a.user)return a.user;if(a.unverified_owner&&!a.user)return a.unverified_owner},isListerAgent:function(a){var b,d,c;return a?null!=(null!=(b=a.unverified_owner)?b.agent_number:void 0)||null!=(null!=(d=a.user)?null!=(c=d.agent)?c.agent_number:void 0:void 0)?!0:!1:null}})}])},{"rb-utils/ribs/ribs.s":194}],194:[function(g,h,l){g("./ribs.js");angular.module("rb-utils").factory("Ribs",["Ribs.Model","Ribs.Collection",function(c,
b){return Ribs}]).factory("Ribs.Model",["$http",function(c){Ribs.Model.prototype.url="";Ribs.Model.prototype.absoluteUrl=function(){if(null==!$window.location.origin)return $window.location.origin=$window.location.protocol+"//"+$window.location.host,url=$window.location.origin+"/"+this.url+"/"+this.get("id"),null!=this.get("slug")&&(url+="/"+this.get("slug")),url};Ribs.Model.prototype.get=function(b){return"undefined"===typeof b||null===b?this.model:"undefined"===typeof this.model||null===this.model?
!1:this.model[b]};Ribs.Model.prototype.set=function(){var b,c;1<arguments.length?(b=arguments[0],c=arguments[1],this.model[b]=c):(b=arguments[0],b.model&&(b=b.model),this.model=this.model?Ribs.equip.extend(this.model,b):b)};Ribs.Model.prototype.fetch=function(b){var e=this,a;b.model&&b.model.id&&(this.model=b.model);if(b.url)a=b.url;else if(a=this.url,"undefined"!=typeof this.id||"undefined"!=typeof this.model.id)a+=this.id||this.model.id;return c.get(a,{params:b.data}).success(function(a,c,k,g){e.set(a);
b.success&&b.success(e.model)}).error(function(a,c,e,g){b.error&&b.error(a)})};Ribs.Model.prototype.save=function(b){var e;if(b.url)e=b.url;else if(e=this.url,"undefined"!=typeof this.id||"undefined"!=typeof this.model.id)e=[e,this.id||this.model.id].join("/");method=b.method?b.method:"undefined"!=typeof this.id||"undefined"!=typeof this.model.id?"PUT":"POST";data=this.model;null!=b.data&&(data=angular.extend(data,b.data));data=this.parseOutput?this.parseOutput(data):data;return c({method:method,
url:e,data:data}).success(function(a,d,c,e){model=a.model||null;b.success&&b.success(a,d,c,e,model);b.complete&&b.complete(a,d,c,e,model)}).error(function(a,d,c,e){b.error&&b.error(a,d,c,e);b.complete&&b.complete(data,d,c,e)})};return Ribs.Model}]).factory("Ribs.Collection",["$http",function(c){Ribs.Collection.prototype.models=[];Ribs.Collection.prototype.modelsIndex={};Ribs.Collection.prototype.primaryKey="id";Ribs.Collection.prototype.url="";Ribs.Collection.prototype.change=0;Ribs.Collection.prototype.state=
{};Ribs.Collection.prototype.setBaseUrl=function(){this.url=baseUrl};Ribs.Collection.prototype.setPrimaryKey=function(){this.primaryKey=primaryKey};Ribs.Collection.prototype.fetch=function(b){var e=this;return c.get(this.url,{params:b.params}).success(function(a,d,c,g){models=a.models||a.results||a;e.add(models);b.success&&b.success(e.models)}).error(function(a,d,c,e){b.error&&b.error(a)})};Ribs.Collection.prototype.add=function(b){b instanceof Array||(b=[b]);for(var c=0;c<b.length;c++)this.models.push(b[c]),
this.modelsIndex[b[c][this.primaryKey]]=c};Ribs.Collection.prototype.get=function(b){return"undefined"===typeof b||null===b?this.models:this.models[this.modelsIndex[b]]};Ribs.Collection.prototype.remove=function(b){this.models.splice(this.modelsIndex[b],1);delete this.modelsIndex[b];b=this.models;this.reset();this.add(b);return this.models};Ribs.Collection.prototype.reset=function(){this.models=[];this.modelsIndex={}};Ribs.Collection.prototype.watch=function(){return this.change};Ribs.Collection.prototype.changed=
function(){this.change++};Ribs.Collection.prototype.state=function(b){return"undefined"===typeof b||null===b?state:state[b]};Ribs.Collection.prototype.emit=function(b,c){var a=new CustomEvent(b,{detail:{data:c||{},sender:this},cancelable:!0,bubbles:!0});window.dispatchEvent(a)};Ribs.Collection.prototype.subscribe=function(b,c){var a=this;window.addEventListener(b,function(b){a===b.detail.sender&&c(b,b.detail.data)})};return Ribs.Collection}])},{"./ribs.js":193}],193:[function(g,h,l){window.Ribs={};
window.equip={};(function(c,b){var e={},a,d;b=function(a,b,d,c){d||(d=function(){return this},d.prototype=a,d=new d,d._super=a);for(var e in b)d[e]=c?null!=b[e].factory?new b[e].factory.apply(null,[d,a].concat(b[e].args||[])):new b[e](d,a):new b[e](d,a);return d};b.inherit=function(a,b){function d(){this.constructor=a}for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);d.prototype=b.prototype;a.prototype=new d;a.__super__=b.prototype;return a};b.apprentice=function(a,d,c){if(!c)return!1;
var e;e=b.inherit(function(){return c.apply(this,arguments)},c);return a&&d?b(a,d,new e(a)):e};b.transform=function(){if(!Parent||!object)return this;var a,b;a=function(){this.constructor=Child};a.prototype=Parent.prototype;b=function(){return parent.apply(this,arguments)};b.prototype=new a;child.__proto__=b.prototype;return child};b.each=function(a,b,d){if(null!=a)if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,d);else if(a.length===+a.length)for(var c=0,g=a.length;c<
g&&b.call(d,a[c],c,a)!==e;c++);else for(c in a)if(a.hasOwnProperty(c)&&b.call(d,a[c],c,a)===e)break};b.extend=function(a){b.each(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d])});return a};b.extendTo=function(a,d){var c=this,e;e=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return c.apply(this,arguments)};b.extend(e,c,d);var g=function(){this.constructor=e};g.prototype=c.prototype;e.prototype=new g;a&&b.extend(e.prototype,a);e.prototype._super=
e.__super__=c.prototype;return e};b.mixin=function(a){b.each(a,function(b){var d=this[b]=a[b];this.prototype[b]=function(){return d.apply(this,arguments)}})};b.result=function(a,b){if(null!=a){var d=a[b];return"function"===typeof d?d.call(a):d}};a=c.Model=function(){this.initialize.apply(this,arguments)};d=c.Collection=function(){this.initialize.apply(this,arguments)};c.equip=b;a.methods=c.Model.prototype;a.prototype.initialize=function(){};d.equip=b;d.methods=c.Collection.prototype;d.prototype.initialize=
function(){};d.extend=a.extend=b.extendTo;d.mixin=a.mixin=b.mixin;d.equip=a.equip=b})(Ribs,equip);(function(){try{new CustomEvent("",{})}catch(c){var b=function(b,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(b,a.bubbles,a.cancelable,a.detail);return d};"undefined"!=typeof window.CustomEvent&&(b.prototype=window.CustomEvent.prototype);window.CustomEvent=b}})()},{}],128:[function(g,h,l){g("./tracker");angular.module("rb-utils").directive("track",
["$rootScope",function(c){return{restrict:"A",replace:!1,link:function(b,c,a){var d,f,g;if(null!=window.tracker){g=f=null;if(null!=a.c||a.track&&"track"!==a.track)f="click",g=a.c||a.track;null!=a.s&&"form"===c[0].tagName.toLowerCase()&&(f="submit",g=a.s||a.track);null!=a.d&&(d=JSON.parse(a.d)||{});if(f&&g)return c.on(f,function(f){f=c.attr("disabled");if("undefined"===typeof f||!1===f)return null!=a.trEval&&(f=b.$eval(a.trEval),"string"===typeof f?g=f:null!=f.data&&null!=f.name?(d=f.data,g=f.name):
d=f),window.tracker.track(g,d)})}}}}])},{"./tracker":129}],56:[function(g,h,l){g("rb-vanilla-login/accounts");g("rb-units/shortlist/shortlist-count-header")},{"rb-units/shortlist/shortlist-count-header":158,"rb-vanilla-login/accounts":200}],200:[function(g,h,l){var c=g("./app");g("./base");var b=g("./facebook_sdk");g("rb-track/tracker/tracker");var e=function(){var a=$("[data-click='sign-up-facebook']"),b=0;return window.setInterval(function(){b+=1;1==b?a.html("Connecting."):2==b?a.html("Connecting.."):
3==b&&(a.html("Connecting..."),b=0)},500)},a=function(a,b){"undefined"==typeof window.Roomboom&&(window.Roomboom={});window.Roomboom.user=a;window.tracker.link_mixpanel_user(a,b);window.tracker.track("User Logged In")};c.bind("click","show-sign-in",function(){c.send("/-/signin")});c.bind("click","show-sign-up",function(){c.send("/-/signup")});c.bind("submit","sign-in",function(){c.send("/-/signin",$(this).serialize(),"post",function(b){"undefined"!==typeof b.model&&"undefined"!==typeof b.model.user&&
a(b.model.user,!1)})});c.bind("submit","sign-up",function(){c.send("/-/signup",$(this).serialize(),"post",function(b){"undefined"!==typeof b.model&&"undefined"!==typeof b.model.user&&a(b.model.user,!0)})});c.bind("click","sign-up-facebook",function(){var d=e();b.checkFbLoginState(function(b){c.send("/-/facebook-connect",JSON.stringify(b),"post",function(b){clearInterval(d);"undefined"!==typeof b.model&&"undefined"!==typeof b.model.user&&a(b.model.user,b.model.is_signed_up)},function(){clearInterval(d)})},
function(){clearInterval(d);$("[data-click='sign-up-facebook']").html("Log in with Facebook")})});c.bind("click","switch-to-sign-in",function(){var a=$("[data-id='signup-dialog-container']");a.removeClass("show");$("[data-id='signup-dialog']").removeClass("show");window.setTimeout(function(){a.remove()},250);c.send("/-/signin")});c.bind("click","switch-to-sign-up",function(){var a=$("[data-id='signin-dialog-container']");a.removeClass("show");$("[data-id='signin-dialog']").removeClass("show");window.setTimeout(function(){a.remove()},
250);c.send("/-/signup")});c.bind("click","hide-dialog-container",function(){$(this).removeClass("show");$(">div",this).removeClass("show");var a=this;window.setTimeout(function(){$(a).remove()},250)});c.bind("remove","remove-dialog-container",function(){$(this).removeClass("show");var a=this;window.setTimeout(function(){$(a).remove()},250)});c.bind("remove","remove-dialog",function(){$(this).removeClass("show");var a=this;window.setTimeout(function(){$(a).remove()},250)});c.bind("html","signed-in",
function(a){$(document).trigger("merge-shortlist",a.user.id);$(document).trigger("initialize-user-model",a.user)})},{"./app":201,"./base":202,"./facebook_sdk":203,"rb-track/tracker/tracker":129}],203:[function(g,h,l){var c=function(){c._init.apply(this,arguments)};c._init=function(){window.fbAsyncInit=function(){FB.init({appId:"202024763332607",cookie:!0,status:!0,xfbml:!0,version:"v2.2"})};(function(b,c,a){var d=b.getElementsByTagName(c)[0];b.getElementById(a)||(b=b.createElement(c),b.id=a,b.src=
"//connect.facebook.net/en_US/all.js",d.parentNode.insertBefore(b,d))})(document,"script","facebook-jssdk");this._fb_permissions=["email","user_location","public_profile"]};c.prototype._statusChangeCallback=function(b,c,a){"connected"===b.status?c(b):FB.login(function(b){"connected"===b.status?c(b):("not_authorized"===b.status?alert("Please give 99.co permission to use your email and public profile"):alert("Please login with facebook before using it to login with 99.co"),a())},{scope:this._fb_permissions.join(",")})};
c.prototype.checkFbLoginState=function(b,c){FB.getLoginStatus(function(a){this._statusChangeCallback(a,b,c)}.bind(this))};g=new c;h.exports=g},{}],202:[function(g,h,l){var c=g("./app");c.bind("html","append",function(b){$(this).append(b.html)});c.bind("html","remove",function(b){$(this).find("[data-remove]").addBack().each(function(){var b=$(this).attr("data-remove");void 0==b?$(this).remove():c.run("remove",b,this)})});c.bind("html","replace",function(b){$(this).replaceWith(b.html)});c.bind("html",
"add-class",function(b){var c=b.html,a=$(this);$(this).removeClass(c);window.setTimeout(function(){a.addClass(c)},20)})},{"./app":201}],201:[function(g,h,l){var c=function(){c._init.apply(this,arguments)};c._init=function(){this._operations={};this._bindListeners()};c.prototype._bindListeners=function(){var c=this;$("body").on("click touchend",function(a){var b=$(a.target).attr("data-click");void 0!=b&&(a.preventDefault(),c._operations.click[b].apply(a.target))});$("body").on("submit",function(a){var b=
$(a.target).attr("data-submit");void 0!=b&&(a.preventDefault(),c._operations.submit[b].apply(a.target))});$(document).on("merge-shortlist",function(a,d){var c=JSON.parse(b("rb")),c=null==c?void 0:c.shortlists,c="undefined"!=typeof c&&0<c.length?c.join(","):"";""!=c&&(data={listing_ids:c,user_id:d},$.ajax({type:"POST",beforeSend:function(a){a.setRequestHeader("X-XSRFToken",b("_xsrf"))},url:"/-/shortlist-listing",data:JSON.stringify(data),success:function(a){if(a.listings&&a.listings.constructor===
Array&&(a=a.listings.length,0<a)){var b=$("[data-id='shortlist-count-header']");b.removeClass("fa-heart-o");b.addClass("fa-heart");b.html("<span class='num badge badge-transparent'>"+a+"</span>")}}}))})};c.prototype._process=function(b){for(var a=0;a<b.updates.length;a++)this._update(b.updates[a])};c.prototype._update=function(b){var a=this;0==b.args.length&&b.args.push("");for(var d=0;d<b.args.length;d++){var c=[b.args[d]];0<b.class_name.length&&c.push("."+b.class_name);0<b.id.length&&c.push("[data-id='"+
b.id+"']");b.user&&"object"==typeof b.user&&c.push("html");c=c.join(" ");$(c).each(function(){a.run("html",b.action,this,b)})}};c.prototype.bind=function(b,a,d){void 0===this._operations[b]&&(this._operations[b]={});this._operations[b][a]=d};c.prototype.run=function(b,a,d,c){this._operations[b][a].call(d,c)};var b=function(b){return b?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(b).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||
null:null};c.prototype.send=function(c,a,d,f,g){var h=this;$.ajax({type:("post"==d?"post":"get").toUpperCase(),beforeSend:function(a){a.setRequestHeader("X-XSRFToken",b("_xsrf"))},url:c,data:a,success:function(a){h._process(a);"undefined"!=typeof f&&f(a)},error:function(a){"undefined"!=typeof g&&g(a)}})};g=new c;h.exports=g},{}],129:[function(g,h,l){g("../banana/banana");window.moment||(window.moment=g("./../../../bower_components/moment/min/moment.min"));(function(c){return c.tracker={init:function(b){},
track:function(b,c){var a,d,f,g,h;c=c||{};g=[this._ga,this._track,this._mp];h=[];a=0;for(f=g.length;a<f;a++)d=g[a],h.push(function(a){return function(a){return d(b,a)}}(this)(c));return h},_ga:function(b,c){if("undefined"!==typeof ga&&null!==ga)return ga("send","event",b,"click")},_mp:function(b,c){if("undefined"!==typeof mixpanel&&null!==mixpanel)return mixpanel.track(b,c)},_track:function(b,e){e.event=b;e.location=location.pathname;e.href=location.href;e.searched_listing_type=(location.search.split("listing_type=")[1]||
"").split("&")[0];e.utm_source=(location.search.split("utm_source=")[1]||"").split("&")[0];e.utm_medium=(location.search.split("utm_medium=")[1]||"").split("&")[0];return c.banana.track(e)},link_mixpanel_user:function(b,e){b.id&&(e?c.mixpanel.alias(b.id):c.mixpanel.identify(b.id),c.mixpanel.register({"User ID":b.id||""}),c.mixpanel.people.set({"User ID":b.id||""}),c.mixpanel.people.increment({"Log In Count":1}),c.mixpanel.people.set({"Log In Last Seen":c.moment.utc().format()}),c.ga("set","user_id",
b.id),c.ga("set","&uid",b.id));b.name&&(c.mixpanel.register({$name:b.name}),c.mixpanel.people.set({$name:b.name}),c.ga("set","name",b.name));if(b.email)return c.mixpanel.register({$email:b.email}),c.mixpanel.people.set({$email:b.email})}}})(window)},{"../banana/banana":127,"./../../../bower_components/moment/min/moment.min":23}],127:[function(g,h,l){(function(c,b){return c.banana={_endpoint:"/split/",_track:function(c,a,d){return b.ajax({type:"POST",url:d||this._endpoint,data:JSON.stringify(a),headers:{"Content-Type":"application/json"}})},
track:function(b){return this._track("event",b,"/-/track")}}})(window,jQuery)},{}],158:[function(g,h,l){var c,b,e=function(a,b){return function(){return a.apply(b,arguments)}};b=g("rb-vanilla-login/getCookie");g=function(){function a(a,b){this.userId=a;this.updateCount=e(this.updateCount,this);this.initCount=e(this.initCount,this);this.getShortlistsSuccessCb=e(this.getShortlistsSuccessCb,this);this.getShortlists=e(this.getShortlists,this);this.userId?(this.getShortlists(this.userId),this.shortlistCount=
null,this.shortlistCountHeaderEl=document.getElementById("shortlist-count-header")):(this.shortlistCount=b,this.saveShortlistWarningEl=document.getElementById("save-shortlist-warning"),this.shortlistCountNotLogInEl=document.getElementById("shortlist-count-not-log-in"),this.initCount(this.shortlistCount))}a.prototype.fetchJSONRequest=function(a,c,e,g,h){var m;m=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");m.onreadystatechange=function(){if(4===m.readyState)if(200===
m.status){if("function"===typeof g)return g(JSON.parse(m.responseText))}else if("function"===typeof h)return h(m.status,m.responseText)};c=c.toUpperCase();m.open(c,a,!0);if("POST"===c)return m.setRequestHeader("Content-Type","application/json; charset=utf-8"),m.setRequestHeader("X-XSRFToken",b("_xsrf")),m.send(JSON.stringify(e));if("GET"===c)return m.send()};a.prototype.getShortlists=function(a){if(a)return this.fetchJSONRequest("/-/get-shortlists?user_id="+a,"get",null,this.getShortlistsSuccessCb,
null)};a.prototype.getShortlistsSuccessCb=function(a){this.shortlistCount=a.listings.length;return this.initCount(this.shortlistCount)};a.prototype.initCount=function(a){if(0<a){if(this.userId)return this.removeClass(this.shortlistCountHeaderEl,"fa-heart-o"),this.addClass(this.shortlistCountHeaderEl,"fa-heart"),this.shortlistCountHeaderEl.innerHTML="<span class='num badge badge-transparent'>"+a+"</span>";this.shortlistCountNotLogInEl.innerHTML=a;this.removeClass(this.saveShortlistWarningEl,"hide");
return this.addClass(this.saveShortlistWarningEl,"enter")}};a.prototype.addClass=function(a,b){return a.classList?a.classList.add(b):a.className+=" "+b};a.prototype.removeClass=function(a,b){return a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")};a.prototype.updateCount=function(a){if(this.userId){if(0<a)return this.shortlistCountHeaderEl.innerHTML="<span class='num badge badge-transparent'>"+a+"</span>",this.removeClass(this.shortlistCountHeaderEl,
"fa-heart-o"),this.addClass(this.shortlistCountHeaderEl,"fa-heart");this.shortlistCountHeaderEl.innerHTML="";this.removeClass(this.shortlistCountHeaderEl,"fa-heart");return this.addClass(this.shortlistCountHeaderEl,"fa-heart-o")}a=this.shortlistCount+a;0<a?(this.shortlistCountNotLogInEl.innerHTML=a,1===a&&(this.removeClass(this.saveShortlistWarningEl,"leave"),this.removeClass(this.saveShortlistWarningEl,"hide"),this.addClass(this.saveShortlistWarningEl,"enter"))):(this.shortlistCountNotLogInEl.innerHTML=
0,this.removeClass(this.saveShortlistWarningEl,"enter"),this.addClass(this.saveShortlistWarningEl,"leave"),window.setTimeout(function(a){return function(){return a.addClass(a.saveShortlistWarningEl,"hide")}}(this),1E3));return this.shortlistCount=a};return a}();null!=(c=window.Roomboom.user)&&c.id?g=new g(window.Roomboom.user.id):(c=JSON.parse(b("rb")),c=null==c?void 0:c.shortlists,c="undefined"===typeof c?0:c.length,g=new g(!1,c));h.exports=g},{"rb-vanilla-login/getCookie":204}],204:[function(g,
h,l){h.exports=function(c){return c?decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(c).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}},{}],23:[function(g,h,l){(function(c){(function(b){function e(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw Error("Implement me");}}function a(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,
invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function d(a,b){var c=!0;return p(function(){c&&(!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+a),c=!1);return b.apply(this,arguments)},b)}function f(a,b){return function(c){return q(a.call(this,c),b)}}function k(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function l(){}function r(a){W(a);p(this,a)}function m(a){a=y(a);var b=a.year||0,c=a.quarter||
0,d=a.month||0,e=a.week||0,f=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+f+7*e;this._months=+d+3*c+12*b;this._data={};this._bubble()}function p(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function w(a){return 0>a?Math.ceil(a):Math.floor(a)}function q(a,b,c){for(var d=""+Math.abs(a);d.length<b;)d="0"+d;return(0<=
a?c?"+":"":"-")+d}function I(a,b,c,d){var e=b._milliseconds,f=b._days;b=b._months;d=null==d?!0:d;e&&a._d.setTime(+a._d+e*c);f&&oa(a,"Date",da(a,"Date")+f*c);b&&pa(a,da(a,"Month")+b*c);d&&n.updateOffset(a,f||b)}function J(a){return"[object Array]"===Object.prototype.toString.call(a)}function v(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&t(a[d])!==t(b[d]))&&g++;return g+f}function u(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,
"$1");a=Ia[a]||Ja[b]||b}return a}function y(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=u(c),b&&(d[b]=a[c]));return d}function A(a){var c,d;if(0===a.indexOf("week"))c=7,d="day";else{if(0!==a.indexOf("month"))return;c=12;d="month"}n[a]=function(e,f){var g,k,m=n.fn._lang[a],h=[];if("number"==typeof e&&(f=e,e=b),k=function(a){a=n().utc().set(d,a);return m.call(n.fn._lang,a,e||"")},null!=f)return k(f);for(g=0;c>g;g++)h.push(k(g));return h}}function t(a){a=+a;var b=0;return 0!==a&&isFinite(a)&&
(b=0<=a?Math.floor(a):Math.ceil(a)),b}function O(a,b){return(new Date(Date.UTC(a,b+1,0))).getUTCDate()}function U(a,b,c){return L(n([a,11,31+b-c]),b,c).week}function P(a){return 0===a%4&&0!==a%100||0===a%400}function W(a){var b;a._a&&-2===a._pf.overflow&&(b=0>a._a[E]||11<a._a[E]?E:1>a._a[C]||a._a[C]>O(a._a[F],a._a[E])?C:0>a._a[D]||23<a._a[D]?D:0>a._a[X]||59<a._a[X]?X:0>a._a[Y]||59<a._a[Y]?Y:0>a._a[Z]||999<a._a[Z]?Z:-1,a._pf._overflowDayOfYear&&(F>b||b>C)&&(b=C),a._pf.overflow=b)}function V(a){return null==
a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&0>a._pf.overflow&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function Q(a){return a?a.toLowerCase().replace("_","-"):a}function R(a,b){return b._isUTC?n(a).zone(b._offset||0):n(a).local()}function B(a){var b,c,d,e,f=0,k=function(a){if(!M[a]&&qa)try{g("./lang/"+a)}catch(b){}return M[a]};if(!a)return n.fn._lang;
if(!J(a)){if(c=k(a))return c;a=[a]}for(;f<a.length;){e=Q(a[f]).split("-");b=e.length;for(d=(d=Q(a[f+1]))?d.split("-"):null;0<b;){if(c=k(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&v(e,d,!0)>=b-1)break;b--}f++}return n.fn._lang}function S(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function ca(a){var b,c,d=a.match(ra);b=0;for(c=d.length;c>b;b++)d[b]=G[d[b]]?G[d[b]]:S(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];
return f}}function T(a,b){return a.isValid()?(b=aa(b,a.lang()),ea[b]||(ea[b]=ca(b)),ea[b](a)):a.lang().invalidDate()}function aa(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(ba.lastIndex=0;0<=d&&ba.test(a);)a=a.replace(ba,c),ba.lastIndex=0,--d;return a}function Ha(a,b){var c=b._strict;switch(a){case "Q":return sa;case "DDDD":return ta;case "YYYY":case "GGGG":case "gggg":return c?Ka:La;case "Y":case "G":case "g":return Ma;case "YYYYYY":case "YYYYY":case "GGGGG":case "ggggg":return c?
Na:Oa;case "S":if(c)return sa;case "SS":if(c)return ua;case "SSS":if(c)return ta;case "DDD":return Pa;case "MMM":case "MMMM":case "dd":case "ddd":case "dddd":return Qa;case "a":case "A":return B(b._l)._meridiemParse;case "X":return Ra;case "Z":case "ZZ":return fa;case "T":return Sa;case "SSSS":return Ta;case "MM":case "DD":case "YY":case "GG":case "gg":case "HH":case "hh":case "mm":case "ss":case "ww":case "WW":return c?ua:va;case "M":case "D":case "d":case "H":case "h":case "m":case "s":case "w":case "W":case "e":case "E":return va;
case "Do":return Ua;default:var c=RegExp,d;d=Va(a.replace("\\","")).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new c(d)}}function wa(a){a=(a||"").match(fa)||[];a=((a[a.length-1]||[])+"").match(Wa)||["-",0,0];var b=+(60*a[1])+t(a[2]);return"+"===a[0]?-b:b}function ha(a){var b,c,d,f=[];if(!a._d){c=new Date;c=a._useUTC?[c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()]:[c.getFullYear(),c.getMonth(),c.getDate()];if(a._w&&null==a._a[C]&&null==a._a[E]){var g,k,m,h,l,p,q;g=a._w;null!=g.GG||null!=g.W||
null!=g.E?(l=1,p=4,k=e(g.GG,a._a[F],L(n(),1,4).year),m=e(g.W,1),h=e(g.E,1)):(q=B(a._l),l=q._week.dow,p=q._week.doy,k=e(g.gg,a._a[F],L(n(),l,p).year),m=e(g.w,1),null!=g.d?(h=g.d,l>h&&++m):h=null!=g.e?g.e+l:l);q=l;var T,r;l=ia(k,0,1).getUTCDay();p=(l=0===l?7:l,h=null!=h?h:q,T=q-l+(l>p?7:0)-(q>l?7:0),r=7*(m-1)+(h-q)+T+1,{year:0<r?k:k-1,dayOfYear:0<r?r:(P(k-1)?366:365)+r});a._a[F]=p.year;a._dayOfYear=p.dayOfYear}a._dayOfYear&&(d=e(a._a[F],c[F]),a._dayOfYear>(P(d)?366:365)&&(a._pf._overflowDayOfYear=!0),
b=ia(d,0,a._dayOfYear),a._a[E]=b.getUTCMonth(),a._a[C]=b.getUTCDate());for(b=0;3>b&&null==a._a[b];++b)a._a[b]=f[b]=c[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];a._d=(a._useUTC?ia:Xa).apply(null,f);null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()+a._tzm)}}function ja(a){if(a._f===n.ISO_8601)return void xa(a);a._a=[];a._pf.empty=!0;var b,c,d,e,f;b=B(a._l);var g=""+a._i,k=g.length,m=0;d=aa(a._f,b).match(ra)||[];for(b=0;b<d.length;b++)if(e=d[b],(c=(g.match(Ha(e,a))||[])[0])&&(f=
g.substr(0,g.indexOf(c)),0<f.length&&a._pf.unusedInput.push(f),g=g.slice(g.indexOf(c)+c.length),m+=c.length),G[e]){c?a._pf.empty=!1:a._pf.unusedTokens.push(e);var h=a,l=void 0,p=h._a;switch(e){case "Q":null!=c&&(p[E]=3*(t(c)-1));break;case "M":case "MM":null!=c&&(p[E]=t(c)-1);break;case "MMM":case "MMMM":l=B(h._l).monthsParse(c);null!=l?p[E]=l:h._pf.invalidMonth=c;break;case "D":case "DD":null!=c&&(p[C]=t(c));break;case "Do":null!=c&&(p[C]=t(parseInt(c,10)));break;case "DDD":case "DDDD":null!=c&&
(h._dayOfYear=t(c));break;case "YY":p[F]=n.parseTwoDigitYear(c);break;case "YYYY":case "YYYYY":case "YYYYYY":p[F]=t(c);break;case "a":case "A":h._isPm=B(h._l).isPM(c);break;case "H":case "HH":case "h":case "hh":p[D]=t(c);break;case "m":case "mm":p[X]=t(c);break;case "s":case "ss":p[Y]=t(c);break;case "S":case "SS":case "SSS":case "SSSS":p[Z]=t(1E3*("0."+c));break;case "X":h._d=new Date(1E3*parseFloat(c));break;case "Z":case "ZZ":h._useUTC=!0;h._tzm=wa(c);break;case "dd":case "ddd":case "dddd":l=B(h._l).weekdaysParse(c);
null!=l?(h._w=h._w||{},h._w.d=l):h._pf.invalidWeekday=c;break;case "w":case "ww":case "W":case "WW":case "d":case "e":case "E":e=e.substr(0,1);case "gggg":case "GGGG":case "GGGGG":e=e.substr(0,2);c&&(h._w=h._w||{},h._w[e]=t(c));break;case "gg":case "GG":h._w=h._w||{},h._w[e]=n.parseTwoDigitYear(c)}}else a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=k-m;0<g.length&&a._pf.unusedInput.push(g);a._isPm&&12>a._a[D]&&(a._a[D]+=12);!1===a._isPm&&12===a._a[D]&&(a._a[D]=0);ha(a);W(a)}function Va(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,
function(a,b,c,d,e){return b||c||d||e})}function xa(a){var b,c,d=a._i,e=Ya.exec(d);if(e){a._pf.iso=!0;b=0;for(c=ka.length;c>b;b++)if(ka[b][1].exec(d)){a._f=ka[b][0]+(e[6]||" ");break}b=0;for(c=la.length;c>b;b++)if(la[b][1].exec(d)){a._f+=la[b][0];break}d.match(fa)&&(a._f+="Z");ja(a)}else a._isValid=!1}function Xa(a,b,c,d,e,f,g){b=new Date(a,b,c,d,e,f,g);return 1970>a&&b.setFullYear(a),b}function ia(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function Za(a,
b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function L(a,b,c){var d;b=c-b;c-=a.day();return c>b&&(c-=7),b-7>c&&(c+=7),d=n(a).add("d",c),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ya(c){var d=c._i,e=c._f;if(null===d||e===b&&""===d)c=n.invalid({nullInput:!0});else{"string"==typeof d&&(c._i=d=B().preparse(d));if(n.isMoment(d)){c=d;var f,g={};for(f in c)c.hasOwnProperty(f)&&za.hasOwnProperty(f)&&(g[f]=c[f]);c=g;c._d=new Date(+d._d)}else if(e)if(J(e)){var k=c,h,m;if(0===k._f.length)k._pf.invalidFormat=
!0,k._d=new Date(0/0);else{for(d=0;d<k._f.length;d++)f=0,g=p({},k),g._pf=a(),g._f=k._f[d],ja(g),V(g)&&(f+=g._pf.charsLeftOver,f+=10*g._pf.unusedTokens.length,g._pf.score=f,(null==m||m>f)&&(m=f,h=g));p(k,h||g)}}else ja(c);else g=c,h=g._i,m=$a.exec(h),h===b?g._d=new Date:m?g._d=new Date(+m[1]):"string"==typeof h?(xa(g),!1===g._isValid&&(delete g._isValid,n.createFromInputFallback(g))):J(h)?(g._a=h.slice(0),ha(g)):"[object Date]"===Object.prototype.toString.call(h)||h instanceof Date?g._d=new Date(+h):
"object"==typeof h?g._d||(k=y(g._i),g._a=[k.year,k.month,k.day,k.hour,k.minute,k.second,k.millisecond],ha(g)):"number"==typeof h?g._d=new Date(h):n.createFromInputFallback(g);c=new r(c)}return c}function Aa(a,b){var c,d;if(1===b.length&&J(b[0])&&(b=b[0]),!b.length)return n();c=b[0];for(d=1;d<b.length;++d)b[d][a](c)&&(c=b[d]);return c}function pa(a,b){var c;return"string"==typeof b&&(b=a.lang().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),O(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+
"Month"](b,c),a)}function da(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function oa(a,b,c){return"Month"===b?pa(a,c):a._d["set"+(a._isUTC?"UTC":"")+b](c)}function H(a,b){return function(c){return null!=c?(oa(this,a,c),n.updateOffset(this,b),this):da(this,a)}}function ab(a){n.duration.fn[a]=function(){return this._data[a]}}function Ba(a,b){n.duration.fn["as"+a]=function(){return+this/b}}function Ca(a){"undefined"==typeof ender&&(Da=ma.moment,ma.moment=a?d("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",
n):n)}for(var n,Da,z,ma="undefined"!=typeof c?c:this,N=Math.round,F=0,E=1,C=2,D=3,X=4,Y=5,Z=6,M={},za={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},qa="undefined"!=typeof h&&h.exports,$a=/^\/?Date\((\-?\d+)/i,bb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,cb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,ra=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,
ba=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,va=/\d\d?/,Pa=/\d{1,3}/,La=/\d{1,4}/,Oa=/[+\-]?\d{1,6}/,Ta=/\d+/,Qa=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,fa=/Z|[\+\-]\d\d:?\d\d/gi,Sa=/T/i,Ra=/[\+\-]?\d+(\.\d{1,3})?/,Ua=/\d{1,2}/,sa=/\d/,ua=/\d\d/,ta=/\d{3}/,Ka=/\d{4}/,Na=/[+-]?\d{6}/,Ma=/[+-]?\d+/,Ya=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
ka=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],la=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Wa=/([\+\-]|\d\d)/gi,na={Milliseconds:1,Seconds:1E3,Minutes:6E4,Hours:36E5,Days:864E5,Months:2592E6,Years:31536E6},Ia={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",
M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ja={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ea={},K={s:45,m:45,h:22,dd:25,dm:45,dy:345},Ea="DDD w W M D d".split(" "),Fa="MDHhmswW".split(""),G={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},
d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return q(this.year()%100,2)},YYYY:function(){return q(this.year(),4)},YYYYY:function(){return q(this.year(),5)},YYYYYY:function(){var a=this.year();return(0<=a?"+":"-")+q(Math.abs(a),6)},gg:function(){return q(this.weekYear()%
100,2)},gggg:function(){return q(this.weekYear(),4)},ggggg:function(){return q(this.weekYear(),5)},GG:function(){return q(this.isoWeekYear()%100,2)},GGGG:function(){return q(this.isoWeekYear(),4)},GGGGG:function(){return q(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},
h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return t(this.milliseconds()/100)},SS:function(){return q(t(this.milliseconds()/10),2)},SSS:function(){return q(this.milliseconds(),3)},SSSS:function(){return q(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+q(t(a/60),2)+":"+q(t(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+q(t(a/60),2)+q(t(a)%60,2)},z:function(){return this.zoneAbbr()},
zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Ga=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Ea.length;)z=Ea.pop(),G[z+"o"]=k(G[z],z);for(;Fa.length;)z=Fa.pop(),G[z+z]=f(G[z],2);G.DDDD=f(G.DDD,3);p(l.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January February March April May June July August September October November December".split(" "),months:function(a){return this._months[a.month()]},
_monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;this._monthsParse||(this._monthsParse=[]);for(b=0;12>b;b++)if(this._monthsParse[b]||(c=n.utc([2E3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdays:function(a){return this._weekdays[a.day()]},
_weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;this._weekdaysParse||(this._weekdaysParse=[]);for(b=0;7>b;b++)if(this._weekdaysParse[b]||(c=n([2E3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",
""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,
b,c){return 11<a?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,
b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[0<a?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return L(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});
n=function(c,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=b),g={},g._isAMomentObject=!0,g._i=c,g._f=d,g._l=e,g._strict=f,g._isUTC=!1,g._pf=a(),ya(g)};n.suppressDeprecationWarnings=!1;n.createFromInputFallback=d("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i)});n.min=function(){var a=[].slice.call(arguments,0);return Aa("isBefore",
a)};n.max=function(){var a=[].slice.call(arguments,0);return Aa("isAfter",a)};n.utc=function(c,d,e,g){var f;return"boolean"==typeof e&&(g=e,e=b),f={},f._isAMomentObject=!0,f._useUTC=!0,f._isUTC=!0,f._l=e,f._i=c,f._f=d,f._strict=g,f._pf=a(),ya(f).utc()};n.unix=function(a){return n(1E3*a)};n.duration=function(a,b){var c,d,e,f=a,g=null;return n.isDuration(a)?f={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(f={},b?f[b]=a:f.milliseconds=a):(g=bb.exec(a))?(c="-"===g[1]?-1:1,f={y:0,d:t(g[C])*
c,h:t(g[D])*c,m:t(g[X])*c,s:t(g[Y])*c,ms:t(g[Z])*c}):(g=cb.exec(a))&&(c="-"===g[1]?-1:1,e=function(a){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*c},f={y:e(g[2]),M:e(g[3]),d:e(g[4]),h:e(g[5]),m:e(g[6]),s:e(g[7]),w:e(g[8])}),d=new m(f),n.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d};n.version="2.7.0";n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";n.ISO_8601=function(){};n.momentProperties=za;n.updateOffset=function(){};n.relativeTimeThreshold=function(a,c){return K[a]===b?!1:
(K[a]=c,!0)};n.lang=function(a,b){var c,d;a?(b?(d=Q(a),b.abbr=d,M[d]||(M[d]=new l),M[d].set(b)):null===b?(delete M[a],a="en"):M[a]||B(a),d=(c=n.duration.fn._lang=n.fn._lang=B(a),c._abbr)):d=n.fn._lang._abbr;return d};n.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),B(a)};n.isMoment=function(a){return a instanceof r||null!=a&&a.hasOwnProperty("_isAMomentObject")};n.isDuration=function(a){return a instanceof m};for(z=Ga.length-1;0<=z;--z)A(Ga[z]);n.normalizeUnits=function(a){return u(a)};
n.invalid=function(a){var b=n.utc(0/0);return null!=a?p(b._pf,a):b._pf.userInvalidated=!0,b};n.parseZone=function(){return n.apply(null,arguments).parseZone()};n.parseTwoDigitYear=function(a){return t(a)+(68<t(a)?1900:2E3)};p(n.fn=r.prototype,{clone:function(){return n(this)},valueOf:function(){return+this._d+6E4*(this._offset||0)},unix:function(){return Math.floor(+this/1E3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?
new Date(+this):this._d},toISOString:function(){var a=n(this).utc();return 0<a.year()&&9999>=a.year()?T(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):T(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){return[this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds(),this.milliseconds()]},isValid:function(){return V(this)},isDSTShifted:function(){return this._a?this.isValid()&&0<v(this._a,(this._isUTC?n.utc(this._a):n(this._a)).toArray()):!1},parsingFlags:function(){return p({},this._pf)},
invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){a=T(this,a||n.defaultFormat);return this.lang().postformat(a)},add:function(a,b){var c;return c="string"==typeof a&&"string"==typeof b?n.duration(isNaN(+b)?+a:+b,isNaN(+b)?b:a):"string"==typeof a?n.duration(+b,a):n.duration(a,b),I(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a&&"string"==typeof b?n.duration(isNaN(+b)?
+a:+b,isNaN(+b)?b:a):"string"==typeof a?n.duration(+b,a):n.duration(a,b),I(this,c,-1),this},diff:function(a,b,c){var d,e;a=R(a,this);var g=6E4*(this.zone()-a.zone());return b=u(b),"year"===b||"month"===b?(d=432E5*(this.daysInMonth()+a.daysInMonth()),e=12*(this.year()-a.year())+(this.month()-a.month()),e+=(this-n(this).startOf("month")-(a-n(a).startOf("month")))/d,e-=6E4*(this.zone()-n(this).startOf("month").zone()-(a.zone()-n(a).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-a,e="second"===
b?d/1E3:"minute"===b?d/6E4:"hour"===b?d/36E5:"day"===b?(d-g)/864E5:"week"===b?(d-g)/6048E5:d),c?e:w(e)},from:function(a,b){return n.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(n(),a)},calendar:function(a){a=a||n();a=R(a,this).startOf("day");a=this.diff(a,"days",!0);a=-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse";return this.format(this.lang().calendar(a,this))},isLeapYear:function(){return P(this.year())},
isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=a){var c;a:{c=a;var d=this.lang();if("string"==typeof c)if(isNaN(c)){if(c=d.weekdaysParse(c),"number"!=typeof c){c=null;break a}}else c=parseInt(c,10)}b=(a=c,this.add({d:a-b}))}return b},month:H("Month",!0),startOf:function(a){switch(a=u(a)){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":this.hours(0);
case "hour":this.minutes(0);case "minute":this.seconds(0);case "second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(a){return a=u(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+n(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<
+n(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)===+R(a,this).startOf(b)},min:d("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(a){return a=n.apply(null,arguments),this>a?this:a}),max:d("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(a){return a=n.apply(null,arguments),a>this?this:a}),zone:function(a,b){var c=this._offset||0;return null==a?this._isUTC?
c:this._d.getTimezoneOffset():("string"==typeof a&&(a=wa(a)),16>Math.abs(a)&&(a*=60),this._offset=a,this._isUTC=!0,c!==a&&(!b||this._changeInProgress?I(this,n.duration(c-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&
this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?n(a).zone():0,0===(this.zone()-a)%60},daysInMonth:function(){return O(this.year(),this.month())},dayOfYear:function(a){var b=N((n(this).startOf("day")-n(this).startOf("year"))/864E5)+1;return null==a?b:this.add("d",a-b)},quarter:function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)},weekYear:function(a){var b=L(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",
a-b)},isoWeekYear:function(a){var b=L(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=L(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},isoWeeksInYear:function(){return U(this.year(),1,4)},weeksInYear:function(){var a=
this._lang._week;return U(this.year(),a.dow,a.doy)},get:function(a){return a=u(a),this[a]()},set:function(a,b){return a=u(a),"function"==typeof this[a]&&this[a](b),this},lang:function(a){return a===b?this._lang:(this._lang=B(a),this)}});n.fn.millisecond=n.fn.milliseconds=H("Milliseconds",!1);n.fn.second=n.fn.seconds=H("Seconds",!1);n.fn.minute=n.fn.minutes=H("Minutes",!1);n.fn.hour=n.fn.hours=H("Hours",!0);n.fn.date=H("Date",!0);n.fn.dates=d("dates accessor is deprecated. Use date instead.",H("Date",
!0));n.fn.year=H("FullYear",!0);n.fn.years=d("years accessor is deprecated. Use year instead.",H("FullYear",!0));n.fn.days=n.fn.day;n.fn.months=n.fn.month;n.fn.weeks=n.fn.week;n.fn.isoWeeks=n.fn.isoWeek;n.fn.quarters=n.fn.quarter;n.fn.toJSON=n.fn.toISOString;p(n.duration.fn=m.prototype,{_bubble:function(){var a,b;a=this._milliseconds;b=this._days;var c=this._months,d=this._data;d.milliseconds=a%1E3;a=w(a/1E3);d.seconds=a%60;a=w(a/60);d.minutes=a%60;a=w(a/60);d.hours=a%24;b+=w(a/24);d.days=b%30;c+=
w(b/30);d.months=c%12;b=w(c/12);d.years=b},weeks:function(){return w(this.days()/7)},valueOf:function(){return this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*t(this._months/12)},humanize:function(a){var b=+this,c;c=!a;var d=this.lang(),e=N(Math.abs(b)/1E3),g=N(e/60),f=N(g/60),k=N(f/24),h=N(k/365),e=e<K.s&&["s",e]||1===g&&["m"]||g<K.m&&["mm",g]||1===f&&["h"]||f<K.h&&["hh",f]||1===k&&["d"]||k<=K.dd&&["dd",k]||k<=K.dm&&["M"]||k<K.dy&&["MM",N(k/30)]||1===h&&["y"]||["yy",h];c=(e[2]=
c,e[3]=0<b,e[4]=d,Za.apply({},e));return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=n.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=n.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=u(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=u(a),this["as"+
a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:n.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),g=Math.abs(this.seconds()+this.milliseconds()/1E3);return this.asSeconds()?(0>this.asSeconds()?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||g?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(g?g+"S":""):"P0D"}});for(z in na)na.hasOwnProperty(z)&&(Ba(z,na[z]),ab(z.toLowerCase()));Ba("Weeks",
6048E5);n.duration.fn.asMonths=function(){return(+this-31536E6*this.years())/2592E6+12*this.years()};n.lang("en",{ordinal:function(a){var b=a%10,b=1===t(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});qa?h.exports=n:"function"==typeof define&&define.amd?(define("moment",function(a,b,c){return c.config&&c.config()&&!0===c.config().noGlobal&&(ma.moment=Da),n}),Ca(!0)):Ca()}).call(this)}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{}],19:[function(g,h,l){(function(c,b,e){function a(a){var c=[];l(c,b.noop).chars(a);return c.join("")}function d(a){var b={};a=a.split(",");var c;for(c=0;c<a.length;c++)b[a[c]]=!0;return b}function g(a,c){function d(a,f,g,h){f=b.lowercase(f);if(P[f])for(;l.last()&&W[l.last()];)e("",l.last());U[f]&&l.last()==f&&e("",f);(h=O[f]||!!h)||l.push(f);var m={};g.replace(q,function(a,b,c,d,e){m[b]=k(c||d||e||"")});c.start&&c.start(f,m,h)}function e(a,d){var f=0,g;if(d=b.lowercase(d))for(f=l.length-
1;0<=f&&l[f]!=d;f--);if(0<=f){for(g=l.length-1;g>=f;g--)c.end&&c.end(l[g]);l.length=f}}"string"!==typeof a&&(a=null===a||"undefined"===typeof a?"":""+a);var f,h,l=[],r=a,t;for(l.last=function(){return l[l.length-1]};a;){t="";h=!0;if(l.last()&&V[l.last()])a=a.replace(RegExp("(.*)<\\s*\\/\\s*"+l.last()+"[^>]*>","i"),function(a,b){b=b.replace(v,"$1").replace(y,"$1");c.chars&&c.chars(k(b));return""}),e("",l.last());else{if(0===a.indexOf("\x3c!--"))f=a.indexOf("--",4),0<=f&&a.lastIndexOf("--\x3e",f)===
f&&(c.comment&&c.comment(a.substring(4,f)),a=a.substring(f+3),h=!1);else if(u.test(a)){if(f=a.match(u))a=a.replace(f[0],""),h=!1}else if(J.test(a)){if(f=a.match(w))a=a.substring(f[0].length),f[0].replace(w,e),h=!1}else I.test(a)&&((f=a.match(p))?(f[4]&&(a=a.substring(f[0].length),f[0].replace(p,d)),h=!1):(t+="<",a=a.substring(1)));h&&(f=a.indexOf("<"),t+=0>f?a:a.substring(0,f),a=0>f?"":a.substring(f),c.chars&&c.chars(k(t)))}if(a==r)throw m("badparse",a);r=a}e()}function k(a){if(!a)return"";var b=
ca.exec(a);a=b[1];var c=b[3];if(b=b[2])S.innerHTML=b.replace(/</g,"&lt;"),b="textContent"in S?S.textContent:S.innerText;return a+b+c}function h(a){return a.replace(/&/g,"&amp;").replace(A,function(a){var b=a.charCodeAt(0);a=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(a-56320)+65536)+";"}).replace(t,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(a,c){var d=!1,e=b.bind(a,a.push);return{start:function(a,f,g){a=b.lowercase(a);!d&&V[a]&&(d=a);d||!0!==
Q[a]||(e("<"),e(a),b.forEach(f,function(d,f){var g=b.lowercase(f),k="img"===a&&"src"===g||"background"===g;!0!==B[g]||!0===R[g]&&!c(d,k)||(e(" "),e(f),e('="'),e(h(d)),e('"'))}),e(g?"/>":">"))},end:function(a){a=b.lowercase(a);d||!0!==Q[a]||(e("</"),e(a),e(">"));a==d&&(d=!1)},chars:function(a){d||e(h(a))}}}var m=b.$$minErr("$sanitize"),p=/^<((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*(>?)/,w=/^<\/\s*([\w:-]+)[^>]*>/,q=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,
I=/^</,J=/^<\//,v=/\x3c!--(.*?)--\x3e/g,u=/<!DOCTYPE([^>]*?)>/i,y=/<!\[CDATA\[(.*?)]]\x3e/g,A=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t=/([^\#-~| |!])/g,O=d("area,br,col,hr,img,wbr");c=d("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr");e=d("rp,rt");var U=b.extend({},e,c),P=b.extend({},c,d("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),W=b.extend({},e,d("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),
V=d("script,style"),Q=b.extend({},O,P,W,U),R=d("background,cite,href,longdesc,src,usemap"),B=b.extend({},R,d("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),S=document.createElement("pre"),ca=/^(\s*)([\s\S]*?)(\s*)$/;b.module("ngSanitize",[]).provider("$sanitize",
function(){this.$get=["$$sanitizeUri",function(a){return function(b){var c=[];g(b,l(c,function(b,c){return!/^unsafe/.test(a(b,c))}));return c.join("")}}]});b.module("ngSanitize").filter("linky",["$sanitize",function(c){var d=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"]/,e=/^mailto:/;return function(f,g){function k(b){b&&p.push(a(b))}function h(a,c){p.push("<a ");b.isDefined(g)&&(p.push('target="'),p.push(g),p.push('" '));p.push('href="');p.push(a);p.push('">');k(c);p.push("</a>")}
if(!f)return f;for(var l,m=f,p=[],q,r;l=m.match(d);)q=l[0],l[2]==l[3]&&(q="mailto:"+q),r=l.index,k(m.substr(0,r)),h(q,l[0].replace(e,"")),m=m.substring(r+l[0].length);k(m);return c(p.join(""))}}])})(window,window.angular)},{}],18:[function(g,h,l){angular.module("ivpusic.cookie",["ipCookie"]);angular.module("ipCookie",["ng"]).factory("ipCookie",["$document",function(c){return function(){function b(b,a,d){var f,g,h,l,m,p;if(d=d||{},void 0!==a)return a="object"==typeof a?JSON.stringify(a):a+"","number"==
typeof d.expires&&(f=d.expires,d.expires=new Date,-1===f?d.expires=new Date("Thu, 01 Jan 1970 00:00:00 GMT"):void 0!==d.expirationUnit?"hours"===d.expirationUnit?d.expires.setHours(d.expires.getHours()+f):"minutes"===d.expirationUnit?d.expires.setMinutes(d.expires.getMinutes()+f):"seconds"===d.expirationUnit?d.expires.setSeconds(d.expires.getSeconds()+f):d.expires.setDate(d.expires.getDate()+f):d.expires.setDate(d.expires.getDate()+f)),c[0].cookie=[encodeURIComponent(b),"=",encodeURIComponent(a),
d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("");d=[];(f=c[0].cookie)&&(d=f.split("; "));f={};p=!1;for(g=0;d.length>g;++g)if(d[g]){h=d[g];l=h.indexOf("=");m=h.substring(0,l);var w;a:{h=h.substring(l+1);try{w=decodeURIComponent(h);break a}catch(q){}w=void 0}if(a=w,!angular.isUndefined(a))if(void 0===b||b===m){try{f[m]=JSON.parse(a)}catch(I){f[m]=a}if(b===m)return f[m];p=!0}}return p&&void 0===b?f:void 0}return b.remove=
function(c,a){var d=void 0!==b(c);return d&&(a||(a={}),a.expires=-1,b(c,"",a)),d},b}()}])},{}]},{},[]);